!function(r){function n(r){return r}function e(r,n,e){for(var t=0,i=n.length,o=e?JSON.parse(JSON.stringify(r)):new Array(i);t<i;++t)o[t]=r[n[t]];return o}C.version="2.0.0-alpha.03",C.permute=e;var t=C.bisect=o(n);function o(r){function n(n,e,t,i){for(;t<i;){var o=t+i>>>1;e<r(n[o])?i=o:t=o+1}return t}return n.right=n,n.left=function(n,e,t,i){for(;t<i;){var o=t+i>>>1;r(n[o])<e?t=o+1:i=o}return t},n}function u(r){function n(r,n,t){for(var i=t-n,o=1+(i>>>1);--o>0;)e(r,o,i,n);return r}function e(n,e,t,i){for(var o,u=n[--i+e],f=r(u);(o=e<<1)<=t&&(o<t&&r(n[i+o])>r(n[i+o+1])&&o++,!(f<=r(n[i+o])));)n[i+e]=n[i+o],e=o;n[i+e]=u}return n.sort=function(r,n,t){for(var i,o=t-n;--o>0;)i=r[n],r[n]=r[n+o],r[n+o]=i,e(r,1,o,n);return r},n}function f(r){var n=u(r);return function(e,t,i,o){var u,f,a,l=new Array(o=Math.min(i-t,o));for(f=0;f<o;++f)l[f]=e[t++];if(n(l,0,o),t<i){u=r(l[0]);do{r(a=e[t])>u&&(l[0]=a,u=r(n(l,0,o)[0]))}while(++t<i)}return l}}function a(r){return function(n,e,t){for(var i=e+1;i<t;++i){for(var o=i,u=n[i],f=r(u);o>e&&r(n[o-1])>f;--o)n[o]=n[o-1];n[o]=u}return n}}function s(r){var n=a(r);function e(r,e,i){return(i-e<h?n:t)(r,e,i)}function t(n,t,i){var o,u=(i-t)/6|0,f=t+u,a=i-1-u,l=t+i-1>>1,s=l-u,h=l+u,c=n[f],v=r(c),p=n[s],g=r(p),d=n[l],y=r(d),b=n[h],x=r(b),k=n[a],w=r(k);v>g&&(o=c,c=p,p=o,o=v,v=g,g=o),x>w&&(o=b,b=k,k=o,o=x,x=w,w=o),v>y&&(o=c,c=d,d=o,o=v,v=y,y=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),v>x&&(o=c,c=b,b=o,o=v,v=x,x=o),y>x&&(o=d,d=b,b=o,o=y,y=x,x=o),g>w&&(o=p,p=k,k=o,o=g,g=w,w=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),x>w&&(o=b,b=k,k=o,o=x,x=w,w=o);var z=p,m=g,E=b,A=x;n[f]=c,n[s]=n[t],n[l]=d,n[h]=n[i-1],n[a]=k;var O=t+1,M=i-2,N=m<=A&&m>=A;if(N)for(var C=O;C<=M;++C){var S=n[C];if((_=r(S))<m)C!==O&&(n[C]=n[O],n[O]=S),++O;else if(_>m)for(;;){if(!((J=r(n[M]))>m)){if(J<m){n[C]=n[O],n[O++]=n[M],n[M--]=S;break}n[C]=n[M],n[M--]=S;break}M--}}else for(C=O;C<=M;C++){S=n[C];if((_=r(S))<m)C!==O&&(n[C]=n[O],n[O]=S),++O;else if(_>A)for(;;){if(!((J=r(n[M]))>A)){J<m?(n[C]=n[O],n[O++]=n[M],n[M--]=S):(n[C]=n[M],n[M--]=S);break}if(--M<C)break}}if(n[t]=n[O-1],n[O-1]=z,n[i-1]=n[M+1],n[M+1]=E,e(n,t,O-1),e(n,M+2,i),N)return n;if(O<f&&M>a){for(var U;(U=r(n[O]))<=m&&U>=m;)++O;for(;(J=r(n[M]))<=A&&J>=A;)--M;for(C=O;C<=M;C++){var _;S=n[C];if((_=r(S))<=m&&_>=m)C!==O&&(n[C]=n[O],n[O]=S),O++;else if(_<=A&&_>=A)for(;;){var J;if(!((J=r(n[M]))<=A&&J>=A)){J<m?(n[C]=n[O],n[O++]=n[M],n[M--]=S):(n[C]=n[M],n[M--]=S);break}if(--M<C)break}}}return e(n,O,M+1)}return e}t.by=o,(C.heap=u(n)).by=u,(C.heapselect=f(n)).by=f,(C.insertionsort=a(n)).by=a,(C.quicksort=s(n)).by=s;var h=32,c=y,v=y,p=y,g=function(r,n){var e=r.length;for(;e<n;)r[e++]=0;return r},d=function(r,n){if(n>32)throw new Error("invalid array width!");return r};function y(r){for(var n=new Array(r),e=-1;++e<r;)n[e]=0;return n}function b(r){this.length=r,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=c(r)}function x(r,n){return function(e){var t=e.length;return[r.left(e,n,0,t),r.right(e,n,0,t)]}}function w(r,n){var e=n[0],t=n[1];return function(n){var i=n.length;return[r.left(n,e,0,i),r.left(n,t,0,i)]}}function z(r){return[0,r.length]}function m(){return null}function E(){return 0}function A(r){return r+1}function O(r){return r-1}function M(r){return function(n,e){return n+ +r(e)}}function N(r){return function(n,e){return n-r(e)}}function C(){var r,o={add:C,remove:J,dimension:R,groupAll:q,size:F,all:j,onChange:B},a=[],h=0,c=[],v=[],p=[],y=[];function C(n){var e=h,t=n.length;return t&&(a=a.concat(n),r.lengthen(h+=t),v.forEach((function(r){r(n,e,t)})),D("dataAdded")),o}function J(){for(var n=S(h,h),e=[],t=0,i=0;t<h;++t)r.zero(t)?e.push(t):n[t]=i++;c.forEach((function(r){r(-1,-1,[],e,!0)})),p.forEach((function(r){r(n)}));for(t=0,i=0;t<h;++t)r.zero(t)||(t!==i&&(r.copy(i,t),a[i]=a[t]),++i);a.length=h=i,r.truncate(i),D("dataRemoved")}function R(o,y){var b,C,J,R,q,F,j,B,G,H,I,K,L,P,Q,T,V={filter:function(r){return null==r?lr():Array.isArray(r)?ar(r):"function"==typeof r?sr(r):fr(r)},filterExact:fr,filterRange:ar,filterFunction:sr,filterAll:lr,top:function(n){var e,t=[],i=rr;for(;--i>=$&&n>0;)r.zero(e=q[i])&&(t.push(a[e]),--n);if(y)for(i=0;i<Q.length&&n>0;i++)r.zero(e=Q[i])&&(t.push(a[e]),--n);return t},bottom:function(n){var e,t,i=[];if(y)for(e=0;e<Q.length&&n>0;e++)r.zero(t=Q[e])&&(i.push(a[t]),--n);e=$;for(;e<rr&&n>0;)r.zero(t=q[e])&&(i.push(a[t]),--n),e++;return i},group:cr,groupAll:function(){var r=cr(m),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r},dispose:vr,remove:vr},W=s((function(r){return B[r]})),X=z,Y=[],Z=[],$=0,rr=0,nr=0;v.unshift(tr),v.push(ir),p.push(or);var er=r.add();function tr(n,t,u){if(y){for(nr=0,d=0,k=[],i=0;i<n.length;i++)for(d=0,k=o(n[i]);d<k.length;d++)nr++;B=[],I=U(n.length),L=S(nr,1),Q=[];var f=U(nr);for(l=0,i=0;i<n.length;i++)if(k=o(n[i]),k.length)for(I[i]=k.length,d=0;d<k.length;d++)B.push(k[d]),f[l]=i,l++;else I[i]=0,Q.push(i);var a=W(U(nr),0,nr);B=e(B,a),G=e(f,a)}else B=n.map(o),G=W(U(u),0,u),B=e(B,G);y&&(u=nr);var s=X(B),c=s[0],v=s[1];if(T)for(i=0;i<u;++i)T(B[i],i)||(r[J][G[i]+t]|=b,y&&(L[i]=1));else{for(i=0;i<c;++i)r[J][G[i]+t]|=b,y&&(L[i]=1);for(i=v;i<u;++i)r[J][G[i]+t]|=b,y&&(L[i]=1)}if(!t)return R=B,q=G,H=I,K=L,$=c,void(rr=v);if(F=R,j=q,P=K,i0=0,i1=0,y&&(old_n0=t,t=F.length,u=nr),R=new Array(y?t+u:h),q=y?new Array(t+u):S(h,h),y&&(K=S(t+u,1)),y){var p=H.length;H=g(H,h);for(var d=0;d+p<h;d++)H[d+p]=I[d]}for(i=0;i0<t&&i1<u;++i)F[i0]<B[i1]?(R[i]=F[i0],y&&(K[i]=P[i0]),q[i]=j[i0++]):(R[i]=B[i1],y&&(K[i]=P[i1]),q[i]=G[i1++]+(y?old_n0:t));for(;i0<t;++i0,++i)R[i]=F[i0],y&&(K[i]=P[i0]),q[i]=j[i0];for(;i1<u;++i1,++i)R[i]=B[i1],y&&(K[i]=P[i1]),q[i]=G[i1]+(y?old_n0:t);s=X(R),$=s[0],rr=s[1]}function ir(r,n,e){Y.forEach((function(r){r(B,G,n,e)})),B=G=null}function or(n){for(var e,t=0,i=0;t<h;++t)r.zero(e=q[t])||(t!==i&&(R[i]=R[t]),q[i]=n[e],++i);for(R.length=i;i<h;)q[i++]=0;var o=X(R);$=o[0],rr=o[1]}function ur(n){var e=n[0],t=n[1];if(T)return T=null,hr((function(r,n){return e<=n&&n<t}),0===n[0]&&n[1]===q.length),$=e,rr=t,V;var i,o,u,f=[],a=[],l=[],s=[];if(e<$)for(i=e,o=Math.min($,t);i<o;++i)f.push(q[i]),l.push(i);else if(e>$)for(i=$,o=Math.min(e,rr);i<o;++i)a.push(q[i]),s.push(i);if(t>rr)for(i=Math.max(e,rr),o=t;i<o;++i)f.push(q[i]),l.push(i);else if(t<rr)for(i=Math.max($,t),o=rr;i<o;++i)a.push(q[i]),s.push(i);if(y){var h=[],v=[];for(i=0;i<f.length;i++)H[f[i]]++,K[l[i]]=0,1===H[f[i]]&&(r[J][f[i]]^=b,h.push(f[i]));for(i=0;i<a.length;i++)H[a[i]]--,K[s[i]]=1,0===H[a[i]]&&(r[J][a[i]]^=b,v.push(a[i]));if(f=h,a=v,0===n[0]&&n[1]===q.length)for(i=0;i<Q.length;i++)r[J][u=Q[i]]&b&&(r[J][u]^=b,f.push(u));else for(i=0;i<Q.length;i++)r[J][u=Q[i]]&b||(r[J][u]^=b,a.push(u))}else{for(i=0;i<f.length;i++)r[J][f[i]]^=b;for(i=0;i<a.length;i++)r[J][a[i]]^=b}return $=e,rr=t,c.forEach((function(r){r(b,J,f,a)})),D("filtered"),V}function fr(r){return ur((X=x(t,r))(R))}function ar(r){return ur((X=w(t,r))(R))}function lr(){return ur((X=z)(R))}function sr(r){return X=z,hr(T=r,!1),$=0,rr=h,V}function hr(n,e){var t,i,o,u=[],f=[],a=[],l=[],s=q.length;if(!y)for(t=0;t<s;++t)!(r[J][i=q[t]]&b)^!!(o=n(R[t],t))&&(o?u.push(i):f.push(i));if(y)for(t=0;t<s;++t)n(R[t],t)?(u.push(q[t]),a.push(t)):(f.push(q[t]),l.push(t));if(y){var h=[],v=[];for(t=0;t<u.length;t++)1===K[a[t]]&&(H[u[t]]++,K[a[t]]=0,1===H[u[t]]&&(r[J][u[t]]^=b,h.push(u[t])));for(t=0;t<f.length;t++)0===K[l[t]]&&(H[f[t]]--,K[l[t]]=1,0===H[f[t]]&&(r[J][f[t]]^=b,v.push(f[t])));if(u=h,f=v,e)for(t=0;t<Q.length;t++)r[J][i=Q[t]]&b&&(r[J][i]^=b,u.push(i));else for(t=0;t<Q.length;t++)r[J][i=Q[t]]&b||(r[J][i]^=b,f.push(i))}else{for(t=0;t<u.length;t++)r[J][u[t]]&b&&(r[J][u[t]]&=C);for(t=0;t<f.length;t++)r[J][f[t]]&b||(r[J][f[t]]|=b)}c.forEach((function(r){r(b,J,u,f)})),D("filtered")}function cr(t){var o={top:W,all:V,reduce:X,reduceCount:$,reduceSum:rr,order:nr,orderNatural:er,size:tr,dispose:ir,remove:ir};Z.push(o);var l,s,v,x,k,w,z,U=8,F=_(U),j=0,B=m,D=m,G=!0,H=t===m;function I(n,o,u,f){y&&(n0old=u,u=R.length-n.length,f=n.length);var v,p,b,x,E,A,O=l,M=y?[]:S(j,F),N=k,q=w,I=z,K=j,V=0,W=0;for(G&&(N=I=m),G&&(q=I=m),l=new Array(j),j=0,s=y?K>1?s:[]:K>1?g(s,h):S(h,F),K&&(b=(p=O[0]).key);W<f&&!((x=t(n[W]))>=x);)++W;for(;W<f;){for(p&&b<=x?(E=p,A=b,M[V]=j,(p=O[++V])&&(b=p.key)):(E={key:x,value:I()},A=x),l[j]=E;x<=A&&(v=o[W]+(y?n0old:u),y?s[v]?s[v].push(j):s[v]=[j]:s[v]=j,E.value=N(E.value,a[v],!0),r.zeroExcept(v,J,C)||(E.value=q(E.value,a[v],!1)),!(++W>=f));)x=t(n[W]);X()}for(;V<K;)l[M[V]=j]=O[V++],X();if(y)for(i=0;i<h;i++)s[i]||(s[i]=[]);if(j>V)if(y)s=e(s,M,!0);else for(V=0;V<u;++V)s[V]=M[s[V]];function X(){y?j++:++j===F&&(M=d(M,U<<=1),s=d(s,U),F=_(U))}v=c.indexOf(B),j>1?(B=L,D=Q):(!j&&H&&(j=1,l=[{key:null,value:I()}]),1===j?(B=P,D=T):(B=m,D=m),s=null),c[v]=B}function K(){if(j>1){for(var n=j,e=l,t=S(n,n),i=0,o=0;i<h;++i)r.zero(i)||(t[s[o]=s[i]]=1,++o);for(l=[],j=0,i=0;i<n;++i)t[i]&&(t[i]=j++,l.push(e[i]));if(j>1)for(i=0;i<o;++i)s[i]=t[s[i]];else s=null;c[c.indexOf(B)]=j>1?(D=Q,B=L):1===j?(D=T,B=P):D=B=m}else if(1===j){if(H)return;for(i=0;i<h;++i)if(!r.zero(i))return;l=[],j=0,c[c.indexOf(B)]=B=D=m}}function L(n,e,t,i,o){var u,f,h,c,v;if(!(n===b&&e===J||G))if(y){for(u=0,c=t.length;u<c;++u)if(r.zeroExcept(h=t[u],J,C))for(f=0;f<s[h].length;f++)(v=l[s[h][f]]).value=k(v.value,a[h],!1,f);for(u=0,c=i.length;u<c;++u)if(r.onlyExcept(h=i[u],J,C,e,n))for(f=0;f<s[h].length;f++)(v=l[s[h][f]]).value=w(v.value,a[h],o,f)}else{for(u=0,c=t.length;u<c;++u)r.zeroExcept(h=t[u],J,C)&&((v=l[s[h]]).value=k(v.value,a[h],!1));for(u=0,c=i.length;u<c;++u)r.onlyExcept(h=i[u],J,C,e,n)&&((v=l[s[h]]).value=w(v.value,a[h],o))}}function P(n,e,t,i,o){if(!(n===b&&e===J||G)){var u,f,s,h=l[0];for(u=0,s=t.length;u<s;++u)r.zeroExcept(f=t[u],J,C)&&(h.value=k(h.value,a[f],!1));for(u=0,s=i.length;u<s;++u)r.onlyExcept(f=i[u],J,C,e,n)&&(h.value=w(h.value,a[f],o))}}function Q(){var n,e,t;for(n=0;n<j;++n)l[n].value=z();if(y){for(n=0;n<h;++n)for(e=0;e<s[n].length;e++)(t=l[s[n][e]]).value=k(t.value,a[n],!0,e);for(n=0;n<h;++n)if(!r.zeroExcept(n,J,C))for(e=0;e<s[n].length;e++)(t=l[s[n][e]]).value=w(t.value,a[n],!1,e)}else{for(n=0;n<h;++n)(t=l[s[n]]).value=k(t.value,a[n],!0);for(n=0;n<h;++n)r.zeroExcept(n,J,C)||((t=l[s[n]]).value=w(t.value,a[n],!1))}}function T(){var n,e=l[0];for(e.value=z(),n=0;n<h;++n)e.value=k(e.value,a[n],!0);for(n=0;n<h;++n)r.zeroExcept(n,J,C)||(e.value=w(e.value,a[n],!1))}function V(){return G&&(D(),G=!1),l}function W(r){var n=v(V(),0,l.length,r);return x.sort(n,0,n.length)}function X(r,n,e){return k=r,w=n,z=e,G=!0,o}function $(){return X(A,O,E)}function rr(r){return X(M(r),N(r),E)}function nr(r){function n(n){return r(n.value)}return v=f(n),x=u(n),o}function er(){return nr(n)}function tr(){return j}function ir(){var r=c.indexOf(B);return r>=0&&c.splice(r,1),(r=Y.indexOf(I))>=0&&Y.splice(r,1),(r=p.indexOf(K))>=0&&p.splice(r,1),o}return arguments.length<1&&(t=n),c.push(B),Y.push(I),p.push(K),I(R,q,0,h),$().orderNatural()}function vr(){Z.forEach((function(r){r.dispose()}));var n=v.indexOf(tr);return n>=0&&v.splice(n,1),(n=v.indexOf(ir))>=0&&v.splice(n,1),(n=p.indexOf(or))>=0&&p.splice(n,1),r.masks[J]&=C,lr()}return J=er.offset,b=er.one,C=~b,tr(a,0,h),ir(a,0,h),V}function q(){var n,e,t,i,o={reduce:s,reduceCount:p,reduceSum:function(r){return s(M(r),N(r),E)},value:function(){u&&(function(){var o;for(n=i(),o=0;o<h;++o)n=e(n,a[o],!0),r.zero(o)||(n=t(n,a[o],!1))}(),u=!1);return n},dispose:g,remove:g},u=!0;function f(i,o){var f;if(!u)for(f=o;f<h;++f)n=e(n,a[f],!0),r.zero(f)||(n=t(n,a[f],!1))}function l(i,o,f,l,s){var h,c,v;if(!u){for(h=0,v=f.length;h<v;++h)r.zero(c=f[h])&&(n=e(n,a[c],s));for(h=0,v=l.length;h<v;++h)r.only(c=l[h],o,i)&&(n=t(n,a[c],s))}}function s(r,n,f){return e=r,t=n,i=f,u=!0,o}function p(){return s(A,O,E)}function g(){var r=c.indexOf(l);return r>=0&&c.splice(r),(r=v.indexOf(f))>=0&&v.splice(r),o}return c.push(l),v.push(f),f(a,0),p()}function F(){return h}function j(){return a}function B(r){if("function"==typeof r)return y.push(r),function(){y.splice(y.indexOf(r),1)};console.warn("onChange callback parameter must be a function!")}function D(r){for(var n=0;n<y.length;n++)y[n](r)}return r=new b(0),arguments.length?C(arguments[0]):o}function S(r,n){return(n<257?c:n<65537?v:p)(r)}function U(r){for(var n=S(r,r),e=-1;++e<r;)n[e]=e;return n}function _(r){return 8===r?256:16===r?65536:4294967296}"undefined"!=typeof Uint8Array&&(c=function(r){return new Uint8Array(r)},v=function(r){return new Uint16Array(r)},p=function(r){return new Uint32Array(r)},g=function(r,n){if(r.length>=n)return r;var e=new r.constructor(n);return e.set(r),e},d=function(r,n){var e;switch(n){case 16:e=v(r.length);break;case 32:e=p(r.length);break;default:throw new Error("invalid array width!")}return e.set(r),e}),b.prototype.lengthen=function(r){var n,e;for(n=0,e=this.subarrays;n<e;++n)this[n]=g(this[n],r);this.length=r},b.prototype.add=function(){var r,n,e,t,i;for(t=0,i=this.subarrays;t<i;++t)if(e=~(r=this.masks[t])&-~r,!((n=this.width-32*t)>=32)||e)return n<32&&e&1<<n&&(this[t]=d(this[t],n<<=1),this.width=32*t+n),this.masks[t]|=e,{offset:t,one:e};return this[this.subarrays]=c(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},b.prototype.copy=function(r,n){var e,t;for(e=0,t=this.subarrays;e<t;++e)this[e][r]=this[e][n]},b.prototype.truncate=function(r){var n,e;for(n=0,e=this.subarrays;n<e;++n){for(var t=this.length-1;t>=r;t--)this[n][t]=0;this[n].length=r}this.length=r},b.prototype.zero=function(r){var n,e;for(n=0,e=this.subarrays;n<e;++n)if(this[n][r])return!1;return!0},b.prototype.zeroExcept=function(r,n,e){var t,i;for(t=0,i=this.subarrays;t<i;++t)if(t===n?this[t][r]&e:this[t][r])return!1;return!0},b.prototype.only=function(r,n,e){var t,i;for(t=0,i=this.subarrays;t<i;++t)if(this[t][r]!=(t===n?e:0))return!1;return!0},b.prototype.onlyExcept=function(r,n,e,t,i){var o,u,f;for(u=0,f=this.subarrays;u<f;++u)if(o=this[u][r],u===n&&(o&=e),o!=(u===t?i:0))return!1;return!0},r.crossfilter=C}("undefined"!=typeof exports&&exports||this);