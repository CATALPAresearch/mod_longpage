/*!
 *  dc 2.1.0-dev
 *  http://dc-js.github.io/dc.js/
 *  Copyright 2012-2015 Nick Zhu & the dc.js Developers
 *  https://github.com/dc-js/dc.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
!function(){function t(t,e){"use strict";var n={version:"2.1.0-dev",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};n.chartRegistry=function(){var t={};function e(e){return e||(e=n.constants.DEFAULT_CHART_GROUP),t[e]||(t[e]=[]),e}return{has:function(e){for(var n in t)if(t[n].indexOf(e)>=0)return!0;return!1},register:function(n,r){r=e(r),t[r].push(n)},deregister:function(n,r){r=e(r);for(var i=0;i<t[r].length;i++)if(t[r][i].anchorName()===n.anchorName()){t[r].splice(i,1);break}},clear:function(e){e?delete t[e]:t={}},list:function(n){return n=e(n),t[n]}}}(),n.registerChart=function(t,e){n.chartRegistry.register(t,e)},n.deregisterChart=function(t,e){n.chartRegistry.deregister(t,e)},n.hasChart=function(t){return n.chartRegistry.has(t)},n.deregisterAllCharts=function(t){n.chartRegistry.clear(t)},n.filterAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].filterAll()},n.refocusAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].focus&&e[r].focus()},n.renderAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].render();null!==n._renderlet&&n._renderlet(t)},n.redrawAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].redraw();null!==n._renderlet&&n._renderlet(t)},n.disableTransitions=!1,n.transition=function(t,e,r,i){if(e<=0||void 0===e||n.disableTransitions)return t;var a=t.transition(i).duration(e);return"function"==typeof r&&r(a),a},n.optionalTransition=function(t,e,r,i){return t?function(t){return n.transition(t,e,r,i)}:function(t){return t}},n.units={},n.units.integers=function(t,e){return Math.abs(e-t)},n.units.ordinal=function(t,e,n){return n},n.units.fp={},n.units.fp.precision=function(t){var e=function(t,r){var i=Math.abs((r-t)/e.resolution);return n.utils.isNegligible(i-Math.floor(i))?Math.floor(i):Math.ceil(i)};return e.resolution=t,e},n.round={},n.round.floor=function(t){return Math.floor(t)},n.round.ceil=function(t){return Math.ceil(t)},n.round.round=function(t){return Math.round(t)},n.override=function(t,e,n){var r=t[e];t["_"+e]=r,t[e]=n},n.renderlet=function(t){return arguments.length?(n._renderlet=t,n):n._renderlet},n.instanceOfChart=function(t){return t instanceof Object&&t.__dcFlag__&&!0},n.errors={},n.errors.Exception=function(t){var e=t||"Unexpected internal error";this.message=e,this.toString=function(){return e},this.stack=(new Error).stack},n.errors.Exception.prototype=Object.create(Error.prototype),n.errors.Exception.prototype.constructor=n.errors.Exception,n.errors.InvalidStateException=function(){n.errors.Exception.apply(this,arguments)},n.errors.InvalidStateException.prototype=Object.create(n.errors.Exception.prototype),n.errors.InvalidStateException.prototype.constructor=n.errors.InvalidStateException,n.errors.BadArgumentException=function(){n.errors.Exception.apply(this,arguments)},n.errors.BadArgumentException.prototype=Object.create(n.errors.Exception.prototype),n.errors.BadArgumentException.prototype.constructor=n.errors.BadArgumentException,n.dateFormat=t.time.format("%m/%d/%Y"),n.printers={},n.printers.filters=function(t){for(var e="",r=0;r<t.length;++r)r>0&&(e+=", "),e+=n.printers.filter(t[r]);return e},n.printers.filter=function(t){var e="";return null!=t&&(t instanceof Array?t.length>=2?e="["+n.utils.printSingleValue(t[0])+" -> "+n.utils.printSingleValue(t[1])+"]":t.length>=1&&(e=n.utils.printSingleValue(t[0])):e=n.utils.printSingleValue(t)),e},n.pluck=function(t,e){return e?function(n,r){return e.call(n,n[t],r)}:function(e){return e[t]}},n.utils={},n.utils.printSingleValue=function(t){var e=""+t;return t instanceof Date?e=n.dateFormat(t):"string"==typeof t?e=t:n.utils.isFloat(t)?e=n.utils.printSingleValue.fformat(t):n.utils.isInteger(t)&&(e=Math.round(t)),e},n.utils.printSingleValue.fformat=t.format(".2f"),n.utils.add=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()+e),n}if("string"==typeof e){var r=+e/100;return t>0?t*(1+r):t*(1-r)}return t+e},n.utils.subtract=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()-e),n}if("string"==typeof e){var r=+e/100;return t<0?t*(1+r):t*(1-r)}return t-e},n.utils.isNumber=function(t){return t===+t},n.utils.isFloat=function(t){return t===+t&&t!==(0|t)},n.utils.isInteger=function(t){return t===+t&&t===(0|t)},n.utils.isNegligible=function(t){return!n.utils.isNumber(t)||t<n.constants.NEGLIGIBLE_NUMBER&&t>-n.constants.NEGLIGIBLE_NUMBER},n.utils.clamp=function(t,e,n){return t<e?e:t>n?n:t};var r=0;return n.utils.uniqueId=function(){return++r},n.utils.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},n.utils.appendOrSelect=function(t,e,n){n=n||e;var r=t.select(e);return r.empty()&&(r=t.append(n)),r},n.utils.safeNumber=function(t){return n.utils.isNumber(+t)?+t:0},n.logger={},n.logger.enableDebugLog=!1,n.logger.warn=function(t){return console&&(console.warn?console.warn(t):console.log&&console.log(t)),n.logger},n.logger.debug=function(t){return n.logger.enableDebugLog&&console&&(console.debug?console.debug(t):console.log&&console.log(t)),n.logger},n.logger.deprecate=function(t,e){var r=!1;return function(){return r||(n.logger.warn(e),r=!0),t.apply(this,arguments)}},n.events={current:null},n.events.trigger=function(t,e){e?(n.events.current=t,setTimeout((function(){t===n.events.current&&t()}),e)):t()},n.filters={},n.filters.RangedFilter=function(t,e){var n=new Array(t,e);return n.isFiltered=function(t){return t>=this[0]&&t<this[1]},n.filterType="RangedFilter",n},n.filters.TwoDimensionalFilter=function(t){if(null===t)return null;var e=t;return e.isFiltered=function(t){return t.length&&t.length===e.length&&t[0]===e[0]&&t[1]===e[1]},e.filterType="TwoDimensionalFilter",e},n.filters.RangedTwoDimensionalFilter=function(t){if(null===t)return null;var e,n=t;return e=n[0]instanceof Array?[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:[[t[0],-1/0],[t[1],1/0]],n.isFiltered=function(t){var n,r;if(t instanceof Array){if(2!==t.length)return!1;n=t[0],r=t[1]}else n=t,r=e[0][1];return n>=e[0][0]&&n<e[1][0]&&r>=e[0][1]&&r<e[1][1]},n.filterType="RangedTwoDimensionalFilter",n},n.baseMixin=function(r){var i,a,o,l,u,c;r.__dcFlag__=n.utils.uniqueId();var s,f,d=200,g=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().width;return e&&e>d?e:d},h=g,p=200,x=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().height;return e&&e>p?e:p},y=x,m=n.pluck("key"),v=n.pluck("value"),A=n.pluck("key"),b=n.pluck("key"),_=!1,k=function(t){return r.keyAccessor()(t)+": "+r.valueAccessor()(t)},C=!0,D=!0,R=750,L=n.printers.filters,S=["dimension","group"],E=n.constants.DEFAULT_CHART_GROUP,w=t.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),M=[],B=function(t,e){return 0===e.length?t.filter(null):1!==e.length||e[0].isFiltered?1===e.length&&"RangedFilter"===e[0].filterType?t.filterRange(e[0]):t.filterFunction((function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0;if(r<=t&&r>=t)return!0}return!1})):t.filterExact(e[0]),e},O=function(t){return t.all()};function T(){u&&u.attr("width",r.width()).attr("height",r.height())}function F(t){if(!r[t]||!r[t]())throw new n.errors.InvalidStateException("Mandatory attribute chart."+t+" is missing on chart[#"+r.anchorName()+"]")}r.height=function(e){return arguments.length?(y=t.functor(e||x),r):y(l.node())},r.width=function(e){return arguments.length?(h=t.functor(e||g),r):h(l.node())},r.minWidth=function(t){return arguments.length?(d=t,r):d},r.minHeight=function(t){return arguments.length?(p=t,r):p},r.dimension=function(t){return arguments.length?(i=t,r.expireCache(),r):i},r.data=function(e){return arguments.length?(O=t.functor(e),r.expireCache(),r):O.call(r,a)},r.group=function(t,e){return arguments.length?(a=t,r._groupName=e,r.expireCache(),r):a},r.ordering=function(t){return arguments.length?(b=t,s=e.quicksort.by(b),r.expireCache(),r):b},r._computeOrderedGroups=function(t){var n=t.slice(0);return n.length<=1?n:(s||(s=e.quicksort.by(b)),s(n,0,n.length))},r.filterAll=function(){return r.filter(null)},r.select=function(t){return l.select(t)},r.selectAll=function(t){return l?l.selectAll(t):null},r.anchor=function(e,i){if(!arguments.length)return o;if(n.instanceOfChart(e))o=e.anchor(),l=e.root(),c=!0;else{if(!e)throw new n.errors.BadArgumentException("parent must be defined");o=e.select&&e.classed?e.node():e,(l=t.select(o)).classed(n.constants.CHART_CLASS,!0),n.registerChart(r,i),c=!1}return E=i,r},r.anchorName=function(){var t=r.anchor();return t&&t.id?t.id:t&&t.replace?t.replace("#",""):"dc-chart"+r.chartID()},r.root=function(t){return arguments.length?(l=t,r):l},r.svg=function(t){return arguments.length?(u=t,r):u},r.resetSvg=function(){return r.select("svg").remove(),u=r.root().append("svg"),T(),u},r.filterPrinter=function(t){return arguments.length?(L=t,r):L},r.controlsUseVisibility=function(t){return arguments.length?(D=t,r):D},r.turnOnControls=function(){if(l){var t=r.controlsUseVisibility()?"visibility":"display";r.selectAll(".reset").style(t,null),r.selectAll(".filter").text(L(r.filters())).style(t,null)}return r},r.turnOffControls=function(){if(l){var t=r.controlsUseVisibility()?"visibility":"display",e=r.controlsUseVisibility()?"hidden":"none";r.selectAll(".reset").style(t,e),r.selectAll(".filter").style(t,e).text(r.filter())}return r},r.transitionDuration=function(t){return arguments.length?(R=t,r):R},r._mandatoryAttributes=function(t){return arguments.length?(S=t,r):S},r.render=function(){w.preRender(r),S&&S.forEach(F);var t=r._doRender();return f&&f.render(),r._activateRenderlets("postRender"),t},r._activateRenderlets=function(t){w.pretransition(r),r.transitionDuration()>0&&u?u.transition().duration(r.transitionDuration()).each("end",(function(){w.renderlet(r),t&&w[t](r)})):(w.renderlet(r),t&&w[t](r))},r.redraw=function(){T(),w.preRedraw(r);var t=r._doRedraw();return f&&f.render(),r._activateRenderlets("postRedraw"),t},r.redrawGroup=function(){n.redrawAll(r.chartGroup())},r.renderGroup=function(){n.renderAll(r.chartGroup())},r._invokeFilteredListener=function(t){void 0!==t&&w.filtered(r,t)},r._invokeZoomedListener=function(){w.zoomed(r)};var N=function(t,e){return null==e?t.length>0:t.some((function(t){return e<=t&&e>=t}))};r.hasFilterHandler=function(t){return arguments.length?(N=t,r):N},r.hasFilter=function(t){return N(M,t)};var G=function(t,e){for(var n=0;n<t.length;n++)if(t[n]<=e&&t[n]>=e){t.splice(n,1);break}return t};r.removeFilterHandler=function(t){return arguments.length?(G=t,r):G};var H=function(t,e){return t.push(e),t};r.addFilterHandler=function(t){return arguments.length?(H=t,r):H};var Y=function(t){return[]};function P(){if(r.dimension()&&r.dimension().filter){var t=B(r.dimension(),M);M=t||M}}return r.resetFilterHandler=function(t){return arguments.length?(Y=t,r):Y},r.replaceFilter=function(t){M=[],r.filter(t)},r.filter=function(t){return arguments.length?(t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach((function(t){r.hasFilter(t)?G(M,t):H(M,t)})):null===t?M=Y(M):r.hasFilter(t)?G(M,t):H(M,t),P(),r._invokeFilteredListener(t),null!==l&&r.hasFilter()?r.turnOnControls():r.turnOffControls(),r):M.length>0?M[0]:null},r.filters=function(){return M},r.highlightSelected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!0),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.fadeDeselected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!0)},r.resetHighlight=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.onClick=function(t){var e=r.keyAccessor()(t);n.events.trigger((function(){r.filter(e),r.redrawGroup()}))},r.filterHandler=function(t){return arguments.length?(B=t,r):B},r._doRender=function(){return r},r._doRedraw=function(){return r},r.legendables=function(){return[]},r.legendHighlight=function(){},r.legendReset=function(){},r.legendToggle=function(){},r.isLegendableHidden=function(){return!1},r.keyAccessor=function(t){return arguments.length?(m=t,r):m},r.valueAccessor=function(t){return arguments.length?(v=t,r):v},r.label=function(t){return arguments.length?(A=t,_=!0,r):A},r.renderLabel=function(t){return arguments.length?(_=t,r):_},r.title=function(t){return arguments.length?(k=t,r):k},r.renderTitle=function(t){return arguments.length?(C=t,r):C},r.renderlet=n.logger.deprecate((function(t){return r.on("renderlet."+n.utils.uniqueId(),t),r}),'chart.renderlet has been deprecated.  Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),r.chartGroup=function(t){return arguments.length?(c||n.deregisterChart(r,E),E=t,c||n.registerChart(r,E),r):E},r.expireCache=function(){return r},r.legend=function(t){return arguments.length?((f=t).parent(r),r):f},r.chartID=function(){return r.__dcFlag__},r.options=function(t){var e=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(var i in t)"function"==typeof r[i]?t[i]instanceof Array&&-1!==e.indexOf(i)?r[i].apply(r,t[i]):r[i].call(r,t[i]):n.logger.debug("Not a valid option setter name: "+i);return r},r.on=function(t,e){return w.on(t,e),r},r},n.marginMixin=function(t){var e={top:10,right:50,bottom:30,left:30};return t.margins=function(n){return arguments.length?(e=n,t):e},t.effectiveWidth=function(){return t.width()-t.margins().left-t.margins().right},t.effectiveHeight=function(){return t.height()-t.margins().top-t.margins().bottom},t},n.colorMixin=function(e){var n=t.scale.category20c(),r=!0,i=function(t){return e.keyAccessor()(t)};return e.colors=function(r){return arguments.length?(n=r instanceof Array?t.scale.quantize().range(r):t.functor(r),e):n},e.ordinalColors=function(n){return e.colors(t.scale.ordinal().range(n))},e.linearColors=function(n){return e.colors(t.scale.linear().range(n).interpolate(t.interpolateHcl))},e.colorAccessor=function(t){return arguments.length?(i=t,r=!1,e):i},e.defaultColorAccessor=function(){return r},e.colorDomain=function(t){return arguments.length?(n.domain(t),e):n.domain()},e.calculateColorDomain=function(){var r=[t.min(e.data(),e.colorAccessor()),t.max(e.data(),e.colorAccessor())];return n.domain(r),e},e.getColor=function(t,e){return n(i.call(this,t,e))},e.colorCalculator=function(t){return arguments.length?(e.getColor=t,e):e.getColor},e},n.coordinateGridMixin=function(e){var r,i,a,o,l;function u(){w=!0,O&&(e.x().domain(W(e.x().domain(),l)),p&&e.x().domain(W(e.x().domain(),p.x().domain())));var t=e.x().domain(),r=n.filters.RangedFilter(t[0],t[1]);e.replaceFilter(r),e.rescale(),e.redraw(),p&&!j(e.filter(),p.filter())&&n.events.trigger((function(){p.replaceFilter(r),p.redraw()})),e._invokeZoomedListener(),n.events.trigger((function(){e.redrawGroup()}),n.constants.EVENT_DELAY),w=!j(t,l)}(e=n.colorMixin(n.marginMixin(n.baseMixin(e)))).colors(t.scale.category10()),e._mandatoryAttributes().push("x");var c,s,f,d,g,h,p,x,y=t.svg.axis().orient("bottom"),m=n.units.integers,v=0,A=!1,b=0,_=t.svg.axis().orient("left"),k=0,C=!1,D=0,R=t.svg.brush(),L=!0,S=!1,E=!1,w=!1,M=!1,B=[1,1/0],O=!0,T=t.behavior.zoom().on("zoom",u),F=t.behavior.zoom().on("zoom",null),N=!1,G=!1,H=0,Y=.5,P=0,U=!1;function I(t,r){e.isOrdinal()?(e.elasticX()||0===o.domain().length)&&o.domain(e._ordinalXDomain()):e.elasticX()&&o.domain([e.xAxisMin(),e.xAxisMax()]);var i,a,l=o.domain();!r&&(a=l,(i=s)&&a&&i.length===a.length&&!i.some((function(t,e){return t.toString()!==a[e].toString()})))||e.rescale(),s=l,e.isOrdinal()?o.rangeBands([0,e.xAxisLength()],P,e._useOuterPadding()?Y:0):o.range([0,e.xAxisLength()]),y=y.scale(e.x()),function(t){var r=t.selectAll("g.vertical");if(E){r.empty()&&(r=t.insert("g",":first-child").attr("class","grid-line vertical").attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var i=y.tickValues()?y.tickValues():"function"==typeof o.ticks?o.ticks(y.ticks()[0]):o.domain(),a=r.selectAll("line").data(i),l=a.enter().append("line").attr("x1",(function(t){return o(t)})).attr("y1",e._xAxisY()-e.margins().top).attr("x2",(function(t){return o(t)})).attr("y2",0).attr("opacity",0);n.transition(l,e.transitionDuration()).attr("opacity",1),n.transition(a,e.transitionDuration()).attr("x1",(function(t){return o(t)})).attr("y1",e._xAxisY()-e.margins().top).attr("x2",(function(t){return o(t)})).attr("y2",0),a.exit().remove()}else r.selectAll("line").remove()}(t)}function V(){return e._xAxisY()-e.margins().top}function z(){return e.anchorName().replace(/[ .#=\[\]]/g,"-")+"-clip"}function X(){var t=n.utils.appendOrSelect(r,"defs"),i=z(),a=n.utils.appendOrSelect(t,"#"+i,"clipPath").attr("id",i),o=2*H;n.utils.appendOrSelect(a,"rect").attr("width",e.xAxisLength()+o).attr("height",e.yAxisHeight()+o).attr("transform","translate(-"+H+", -"+H+")")}function q(t){e.isOrdinal()&&(L=!1),I(e.g(),t),e._prepareYAxis(e.g()),e.plotData(),(e.elasticX()||M||t)&&e.renderXAxis(e.g()),(e.elasticY()||M||t)&&e.renderYAxis(e.g()),t?e.renderBrush(e.g(),!1):e.redrawBrush(e.g(),M),e.fadeDeselectedArea(),M=!1}function K(){G?e._enableMouseZoom():N&&e._disableMouseZoom()}function W(e,n){var r=[];return r[0]=t.max([e[0],n[0]]),r[1]=t.min([e[1],n[1]]),r}function j(t,e){return!t&&!e||!(!t||!e)&&(0===t.length&&0===e.length||t[0].valueOf()===e[0].valueOf()&&t[1].valueOf()===e[1].valueOf())}return e.rescale=function(){return h=void 0,M=!0,e},e.rangeChart=function(t){return arguments.length?((p=t).focusChart(e),e):p},e.zoomScale=function(t){return arguments.length?(B=t,e):B},e.zoomOutRestrict=function(t){return arguments.length?(B[0]=t?1:0,O=t,e):O},e._generateG=function(t){return r=void 0===t?e.svg():t,i=r.append("g"),a=i.append("g").attr("class","chart-body").attr("transform","translate("+e.margins().left+", "+e.margins().top+")").attr("clip-path","url(#"+z()+")"),i},e.g=function(t){return arguments.length?(i=t,e):i},e.mouseZoomable=function(t){return arguments.length?(G=t,e):G},e.chartBodyG=function(t){return arguments.length?(a=t,e):a},e.x=function(t){return arguments.length?(l=(o=t).domain(),e.rescale(),e):o},e.xOriginalDomain=function(){return l},e.xUnits=function(t){return arguments.length?(m=t,e):m},e.xAxis=function(t){return arguments.length?(y=t,e):y},e.elasticX=function(t){return arguments.length?(A=t,e):A},e.xAxisPadding=function(t){return arguments.length?(v=t,e):v},e.xUnitCount=function(){if(void 0===h){var t=e.xUnits()(e.x().domain()[0],e.x().domain()[1],e.x().domain());h=t instanceof Array?t.length:t}return h},e.useRightYAxis=function(t){return arguments.length?(U=t,e):U},e.isOrdinal=function(){return e.xUnits()===n.units.ordinal},e._useOuterPadding=function(){return!0},e._ordinalXDomain=function(){return e._computeOrderedGroups(e.data()).map(e.keyAccessor())},e.renderXAxis=function(t){var r=t.selectAll("g.x");r.empty()&&(r=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e._xAxisY()+")"));var i=t.selectAll("text.x-axis-label");i.empty()&&e.xAxisLabel()&&(i=t.append("text").attr("class","x-axis-label").attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-b)+")").attr("text-anchor","middle")),e.xAxisLabel()&&i.text()!==e.xAxisLabel()&&i.text(e.xAxisLabel()),n.transition(r,e.transitionDuration()).attr("transform","translate("+e.margins().left+","+e._xAxisY()+")").call(y),n.transition(i,e.transitionDuration()).attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-b)+")")},e._xAxisY=function(){return e.height()-e.margins().bottom},e.xAxisLength=function(){return e.effectiveWidth()},e.xAxisLabel=function(t,n){return arguments.length?(c=t,e.margins().bottom-=b,b=void 0===n?12:n,e.margins().bottom+=b,e):c},e._prepareYAxis=function(n){if(void 0===f||e.elasticY()){void 0===f&&(f=t.scale.linear());var r=e.yAxisMin()||0,i=e.yAxisMax()||0;f.domain([r,i]).rangeRound([e.yAxisHeight(),0])}f.range([e.yAxisHeight(),0]),_=_.scale(f),U&&_.orient("right"),e._renderHorizontalGridLinesForAxis(n,f,_)},e.renderYAxisLabel=function(t,r,i,a){a=a||D;var o=e.g().selectAll("text.y-axis-label."+t+"-label"),l=e.margins().top+e.yAxisHeight()/2;o.empty()&&r&&(o=e.g().append("text").attr("transform","translate("+a+","+l+"),rotate("+i+")").attr("class","y-axis-label "+t+"-label").attr("text-anchor","middle").text(r)),r&&o.text()!==r&&o.text(r),n.transition(o,e.transitionDuration()).attr("transform","translate("+a+","+l+"),rotate("+i+")")},e.renderYAxisAt=function(t,r,i){var a=e.g().selectAll("g."+t);a.empty()&&(a=e.g().append("g").attr("class","axis "+t).attr("transform","translate("+i+","+e.margins().top+")")),n.transition(a,e.transitionDuration()).attr("transform","translate("+i+","+e.margins().top+")").call(r)},e.renderYAxis=function(){var t=U?e.width()-e.margins().right:e._yAxisX();e.renderYAxisAt("y",_,t);var n=U?e.width()-D:D,r=U?90:-90;e.renderYAxisLabel("y",e.yAxisLabel(),r,n)},e._renderHorizontalGridLinesForAxis=function(t,r,i){var a=t.selectAll("g.horizontal");if(S){var o=i.tickValues()?i.tickValues():r.ticks(i.ticks()[0]);a.empty()&&(a=t.insert("g",":first-child").attr("class","grid-line horizontal").attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var l=a.selectAll("line").data(o),u=l.enter().append("line").attr("x1",1).attr("y1",(function(t){return r(t)})).attr("x2",e.xAxisLength()).attr("y2",(function(t){return r(t)})).attr("opacity",0);n.transition(u,e.transitionDuration()).attr("opacity",1),n.transition(l,e.transitionDuration()).attr("x1",1).attr("y1",(function(t){return r(t)})).attr("x2",e.xAxisLength()).attr("y2",(function(t){return r(t)})),l.exit().remove()}else a.selectAll("line").remove()},e._yAxisX=function(){return e.useRightYAxis()?e.width()-e.margins().right:e.margins().left},e.yAxisLabel=function(t,n){return arguments.length?(d=t,e.margins().left-=D,D=void 0===n?12:n,e.margins().left+=D,e):d},e.y=function(t){return arguments.length?(f=t,e.rescale(),e):f},e.yAxis=function(t){return arguments.length?(_=t,e):_},e.elasticY=function(t){return arguments.length?(C=t,e):C},e.renderHorizontalGridLines=function(t){return arguments.length?(S=t,e):S},e.renderVerticalGridLines=function(t){return arguments.length?(E=t,e):E},e.xAxisMin=function(){var r=t.min(e.data(),(function(t){return e.keyAccessor()(t)}));return n.utils.subtract(r,v)},e.xAxisMax=function(){var r=t.max(e.data(),(function(t){return e.keyAccessor()(t)}));return n.utils.add(r,v)},e.yAxisMin=function(){var r=t.min(e.data(),(function(t){return e.valueAccessor()(t)}));return n.utils.subtract(r,k)},e.yAxisMax=function(){var r=t.max(e.data(),(function(t){return e.valueAccessor()(t)}));return n.utils.add(r,k)},e.yAxisPadding=function(t){return arguments.length?(k=t,e):k},e.yAxisHeight=function(){return e.effectiveHeight()},e.round=function(t){return arguments.length?(g=t,e):g},e._rangeBandPadding=function(t){return arguments.length?(P=t,e):P},e._outerRangeBandPadding=function(t){return arguments.length?(Y=t,e):Y},n.override(e,"filter",(function(t){return arguments.length?(e._filter(t),t?e.brush().extent(t):e.brush().clear(),e):e._filter()})),e.brush=function(t){return arguments.length?(R=t,e):R},e.renderBrush=function(t){if(L){R.on("brush",e._brushing),R.on("brushstart",e._disableMouseZoom),R.on("brushend",K);var n=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")").call(R.x(e.x()));e.setBrushY(n,!1),e.setHandlePaths(n),e.hasFilter()&&e.redrawBrush(t,!1)}},e.setHandlePaths=function(t){t.selectAll(".resize").append("path").attr("d",e.resizeHandlePath)},e.setBrushY=function(t){t.selectAll(".brush rect").attr("height",V()),t.selectAll(".resize path").attr("d",e.resizeHandlePath)},e.extendBrush=function(){var t=R.extent();return e.round()&&(t[0]=t.map(e.round())[0],t[1]=t.map(e.round())[1],i.select(".brush").call(R.extent(t))),t},e.brushIsEmpty=function(t){return R.empty()||!t||t[1]<=t[0]},e._brushing=function(){var t=e.extendBrush();if(e.redrawBrush(i,!1),e.brushIsEmpty(t))n.events.trigger((function(){e.filter(null),e.redrawGroup()}),n.constants.EVENT_DELAY);else{var r=n.filters.RangedFilter(t[0],t[1]);n.events.trigger((function(){e.replaceFilter(r),e.redrawGroup()}),n.constants.EVENT_DELAY)}},e.redrawBrush=function(t,r){if(L){e.filter()&&e.brush().empty()&&e.brush().extent(e.filter());var i=n.optionalTransition(r,e.transitionDuration())(t.select("g.brush"));e.setBrushY(i),i.call(e.brush().x(e.x()).extent(e.brush().extent()))}e.fadeDeselectedArea()},e.fadeDeselectedArea=function(){},e.resizeHandlePath=function(t){var e=+("e"===t),n=e?1:-1,r=V()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+e+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)},e.clipPadding=function(t){return arguments.length?(H=t,e):H},e._preprocessData=function(){},e._doRender=function(){return e.resetSvg(),e._preprocessData(),e._generateG(),X(),q(!0),K(),e},e._doRedraw=function(){return e._preprocessData(),q(!1),X(),e},e._enableMouseZoom=function(){N=!0,T.x(e.x()).scaleExtent(B).size([e.width(),e.height()]).duration(e.transitionDuration()),e.root().call(T)},e._disableMouseZoom=function(){e.root().call(F)},e.focus=function(t){!function(t){return t instanceof Array&&t.length>1}(t)?e.x().domain(l):e.x().domain(t),T.x(e.x()),u()},e.refocused=function(){return w},e.focusChart=function(t){return arguments.length?(x=t,e.on("filtered",(function(t){t.filter()?j(t.filter(),x.filter())||n.events.trigger((function(){x.focus(t.filter())})):n.events.trigger((function(){x.x().domain(x.xOriginalDomain())}))})),e):x},e.brushOn=function(t){return arguments.length?(L=t,e):L},e},n.stackMixin=function(e){var r=t.layout.stack().values((function(n,r){var i=n.accessor||e.valueAccessor();return n.name=String(n.name||r),n.values=n.group.all().map((function(t,r){return{x:e.keyAccessor()(t,r),y:n.hidden?null:i(t,r),data:t,layer:n.name,hidden:n.hidden}})),n.values=n.values.filter(function(){if(!e.x())return t.functor(!0);var n=e.x().domain();if(e.isOrdinal())return function(){return!0};if(e.elasticX())return function(){return!0};return function(t){return t.x>=n[0]&&t.x<=n[n.length-1]}}()),n.values})),i=[],a={},o=!1;function l(t){var e=i.map(n.pluck("name")).indexOf(t);return i[e]}function u(){var t=e.data().map((function(t){return t.values}));return Array.prototype.concat.apply([],t)}function c(t){return!t.hidden}return e.stack=function(t,n,r){if(!arguments.length)return i;arguments.length<=2&&(r=n);var a={group:t};return"string"==typeof n&&(a.name=n),"function"==typeof r&&(a.accessor=r),i.push(a),e},n.override(e,"group",(function(t,n,r){return arguments.length?(i=[],a={},e.stack(t,n),r&&e.valueAccessor(r),e._group(t,n)):e._group()})),e.hidableStacks=function(t){return arguments.length?(o=t,e):o},e.hideStack=function(t){var n=l(t);return n&&(n.hidden=!0),e},e.showStack=function(t){var n=l(t);return n&&(n.hidden=!1),e},e.getValueAccessorByIndex=function(t){return i[t].accessor||e.valueAccessor()},e.yAxisMin=function(){var r=t.min(u(),(function(t){return t.y+t.y0<t.y0?t.y+t.y0:t.y0}));return n.utils.subtract(r,e.yAxisPadding())},e.yAxisMax=function(){var r=t.max(u(),(function(t){return t.y+t.y0}));return n.utils.add(r,e.yAxisPadding())},e.xAxisMin=function(){var r=t.min(u(),n.pluck("x"));return n.utils.subtract(r,e.xAxisPadding())},e.xAxisMax=function(){var r=t.max(u(),n.pluck("x"));return n.utils.add(r,e.xAxisPadding())},n.override(e,"title",(function(t,n){return t?"function"==typeof t?e._title(t):t===e._groupName&&"function"==typeof n?e._title(n):"function"!=typeof n?a[t]||e._title():(a[t]=n,e):e._title()})),e.stackLayout=function(t){return arguments.length?(r=t,e):r},e.data((function(){var t=i.filter(c);return t.length?e.stackLayout()(t):[]})),e._ordinalXDomain=function(){var t=u().map(n.pluck("data"));return e._computeOrderedGroups(t).map(e.keyAccessor())},e.colorAccessor((function(t){return this.layer||this.name||t.name||t.layer})),e.legendables=function(){return i.map((function(t,n){return{chart:e,name:t.name,hidden:t.hidden||!1,color:e.getColor.call(t,t.values,n)}}))},e.isLegendableHidden=function(t){var e=l(t.name);return!!e&&e.hidden},e.legendToggle=function(t){o&&(e.isLegendableHidden(t)?e.showStack(t.name):e.hideStack(t.name),e.renderGroup())},e},n.capMixin=function(e){var r=1/0,i="Others",a=function(n){var r=t.sum(n,e.valueAccessor()),a=e.group().all(),o=t.sum(a,e.valueAccessor()),l=n.map(e.keyAccessor()),u=a.map(e.keyAccessor()),c=t.set(l),s=u.filter((function(t){return!c.has(t)}));return o>r?n.concat([{others:s,key:i,value:o-r}]):n};return e.cappedKeyAccessor=function(t,n){return t.others?t.key:e.keyAccessor()(t,n)},e.cappedValueAccessor=function(t,n){return t.others?t.value:e.valueAccessor()(t,n)},e.data((function(t){if(r===1/0)return e._computeOrderedGroups(t.all());var n=t.top(r);return n=e._computeOrderedGroups(n),a?a(n):n})),e.cap=function(t){return arguments.length?(r=t,e):r},e.othersLabel=function(t){return arguments.length?(i=t,e):i},e.othersGrouper=function(t){return arguments.length?(a=t,e):a},n.override(e,"onClick",(function(t){t.others&&e.filter([t.others]),e._onClick(t)})),e},n.bubbleMixin=function(e){var r=.3,i=10;e.BUBBLE_NODE_CLASS="node",e.BUBBLE_CLASS="bubble",e.MIN_RADIUS=10,(e=n.colorMixin(e)).renderLabel(!0),e.data((function(t){return t.top(1/0)}));var a=t.scale.linear().domain([0,100]),o=function(t){return t.r};e.r=function(t){return arguments.length?(a=t,e):a},e.radiusValueAccessor=function(t){return arguments.length?(o=t,e):o},e.rMin=function(){return t.min(e.data(),(function(t){return e.radiusValueAccessor()(t)}))},e.rMax=function(){return t.max(e.data(),(function(t){return e.radiusValueAccessor()(t)}))},e.bubbleR=function(t){var n=e.radiusValueAccessor()(t),r=e.r()(n);return(isNaN(r)||n<=0)&&(r=0),r};var l=function(t){return e.label()(t)},u=function(t){return e.bubbleR(t)>i?1:0};e._doRenderLabel=function(t){if(e.renderLabel()){var r=t.select("text");r.empty()&&(r=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)),r.attr("opacity",0).text(l),n.transition(r,e.transitionDuration()).attr("opacity",u)}},e.doUpdateLabels=function(t){if(e.renderLabel()){var r=t.selectAll("text").text(l);n.transition(r,e.transitionDuration()).attr("opacity",u)}};var c=function(t){return e.title()(t)};return e._doRenderTitles=function(t){e.renderTitle()&&(t.select("title").empty()&&t.append("title").text(c))},e.doUpdateTitles=function(t){e.renderTitle()&&t.selectAll("title").text(c)},e.minRadius=function(t){return arguments.length?(e.MIN_RADIUS=t,e):e.MIN_RADIUS},e.minRadiusWithLabel=function(t){return arguments.length?(i=t,e):i},e.maxBubbleRelativeSize=function(t){return arguments.length?(r=t,e):r},e.fadeDeselectedArea=function(){e.hasFilter()?e.selectAll("g."+e.BUBBLE_NODE_CLASS).each((function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)})):e.selectAll("g."+e.BUBBLE_NODE_CLASS).each((function(){e.resetHighlight(this)}))},e.isSelectedNode=function(t){return e.hasFilter(t.key)},e.onClick=function(t){var r=t.key;n.events.trigger((function(){e.filter(r),e.redrawGroup()}))},e},n.pieChart=function(e,r){var i,a,o,l,u,c,s="empty",f=0,d=0,g=.5,h=n.capMixin(n.colorMixin(n.baseMixin({})));function p(){i=a||t.min([h.width(),h.height()])/2;var e,r=y(),l=t.layout.pie().sort(null).value(h.cappedValueAccessor);if(t.sum(h.data(),h.valueAccessor())?(e=l(h.data()),o.classed("empty-chart",!1)):(e=l([{key:s,value:1,others:[s]}]),o.classed("empty-chart",!0)),o){var u=o.selectAll("g.pie-slice").data(e);!function(t,e,r){var i=function(t){return t.enter().append("g").attr("class",(function(t,e){return"pie-slice _"+e}))}(t);(function(t,e){var r=t.append("path").attr("fill",A).on("click",b).attr("d",(function(t,n){return _(t,n,e)}));n.transition(r,h.transitionDuration(),(function(t){t.attrTween("d",v)}))})(i,e),function(t){h.renderTitle()&&t.append("title").text((function(t){return h.title()(t.data)}))}(i),function(t,e){if(h.renderLabel()){var n=o.selectAll("text.pie-slice").data(t);n.exit().remove(),x(n.enter().append("text").attr("class",(function(t,e){var n="pie-slice _"+e;return c&&(n+=" external"),n})).on("click",b),e)}}(r,e)}(u,r,e),function(t,e){(function(t,e){var r=o.selectAll("g.pie-slice").data(t).select("path").attr("d",(function(t,n){return _(t,n,e)}));n.transition(r,h.transitionDuration(),(function(t){t.attrTween("d",v)})).attr("fill",A)})(t,e),function(t,e){if(h.renderLabel()){x(o.selectAll("text.pie-slice").data(t),e)}}(t,e),function(t){h.renderTitle()&&o.selectAll("g.pie-slice").data(t).select("title").text((function(t){return h.title()(t.data)}))}(t)}(e,r),function(t){t.exit().remove()}(u),h.hasFilter()?h.selectAll("g.pie-slice").each((function(t){m(t)?h.highlightSelected(this):h.fadeDeselected(this)})):h.selectAll("g.pie-slice").each((function(){h.resetHighlight(this)})),n.transition(o,h.transitionDuration()).attr("transform","translate("+h.cx()+","+h.cy()+")")}}function x(e,r){n.transition(e,h.transitionDuration()).attr("transform",(function(e){return function(e,n){var r;r=c?t.svg.arc().outerRadius(i-d+c).innerRadius(i-d+c).centroid(e):n.centroid(e);return isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}(e,r)})).attr("text-anchor","middle").text((function(t){return!function(t){return 0===h.cappedValueAccessor(t)}(t.data)&&!function(t){var e=t.endAngle-t.startAngle;return isNaN(e)||e<g}(t)||m(t)?h.label()(t.data):""}))}function y(){return t.svg.arc().outerRadius(i-d).innerRadius(f)}function m(t){return h.hasFilter(h.cappedKeyAccessor(t.data))}function v(e){e.innerRadius=f;var n=this._current;(function(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)})(n)&&(n={startAngle:0,endAngle:0});var r=t.interpolate(n,e);return this._current=r(0),function(t){return _(r(t),0,y())}}function A(t,e){return h.getColor(t.data,e)}function b(t,e){"empty-chart"!==o.attr("class")&&h.onClick(t.data,e)}function _(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function k(e,n){h.selectAll("g.pie-slice").each((function(r){e.name===r.data.key&&t.select(this).classed("highlight",n)}))}return h.colorAccessor(h.cappedKeyAccessor),h.title((function(t){return h.cappedKeyAccessor(t)+": "+h.cappedValueAccessor(t)})),h.slicesCap=h.cap,h.label(h.cappedKeyAccessor),h.renderLabel(!0),h.transitionDuration(350),h._doRender=function(){return h.resetSvg(),o=h.svg().append("g").attr("transform","translate("+h.cx()+","+h.cy()+")"),p(),h},h.externalRadiusPadding=function(t){return arguments.length?(d=t,h):d},h.innerRadius=function(t){return arguments.length?(f=t,h):f},h.radius=function(t){return arguments.length?(a=t,h):a},h.cx=function(t){return arguments.length?(l=t,h):l||h.width()/2},h.cy=function(t){return arguments.length?(u=t,h):u||h.height()/2},h._doRedraw=function(){return p(),h},h.minAngleForLabel=function(t){return arguments.length?(g=t,h):g},h.emptyTitle=function(t){return 0===arguments.length?s:(s=t,h)},h.externalLabels=function(t){return 0===arguments.length?c:(c=t||void 0,h)},h.legendables=function(){return h.data().map((function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:h};return n.color=h.getColor(t,e),n}))},h.legendHighlight=function(t){k(t,!0)},h.legendReset=function(t){k(t,!1)},h.legendToggle=function(t){h.onClick({key:t.name,others:t.others})},h.anchor(e,r)},n.barChart=function(e,r){var i,a=n.stackMixin(n.coordinateGridMixin({})),o=2,l=!1,u=!1;function c(t){return n.utils.safeNumber(Math.abs(a.y()(t.y+t.y0)-a.y()(t.y0)))}function s(e,n){return function(){var r=t.select(this).attr("fill")===e;return n?!r:r}}return n.override(a,"rescale",(function(){return a._rescale(),i=void 0,a})),n.override(a,"render",(function(){return a.round()&&l&&!u&&n.logger.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),a._render()})),a.plotData=function(){var e=a.chartBodyG().selectAll("g.stack").data(a.data());!function(){if(void 0===i){var t=a.xUnitCount();((i=a.isOrdinal()&&void 0===o?Math.floor(a.x().rangeBand()):o?Math.floor((a.xAxisLength()-(t-1)*o)/t):Math.floor(a.xAxisLength()/(1+a.barPadding())/t))===1/0||isNaN(i)||i<1)&&(i=1)}}(),e.enter().append("g").attr("class",(function(t,e){return"stack _"+e})),e.each((function(e,r){!function(t,e,r){var u=t.selectAll("rect.bar").data(r.values,n.pluck("x")),s=u.enter().append("rect").attr("class","bar").attr("fill",n.pluck("data",a.getColor)).attr("y",a.yAxisHeight()).attr("height",0);a.renderTitle()&&s.append("title").text(n.pluck("data",a.title(r.name)));a.isOrdinal()&&u.on("click",a.onClick);n.transition(u,a.transitionDuration()).attr("x",(function(t){var e=a.x()(t.x);return l&&(e-=i/2),a.isOrdinal()&&void 0!==o&&(e+=o/2),n.utils.safeNumber(e)})).attr("y",(function(t){var e=a.y()(t.y+t.y0);return t.y<0&&(e-=c(t)),n.utils.safeNumber(e)})).attr("width",i).attr("height",(function(t){return c(t)})).attr("fill",n.pluck("data",a.getColor)).select("title").text(n.pluck("data",a.title(r.name))),n.transition(u.exit(),a.transitionDuration()).attr("height",0).remove()}(t.select(this),0,e)}))},a.fadeDeselectedArea=function(){var t=a.chartBodyG().selectAll("rect.bar"),e=a.brush().extent();if(a.isOrdinal())a.hasFilter()?(t.classed(n.constants.SELECTED_CLASS,(function(t){return a.hasFilter(t.x)})),t.classed(n.constants.DESELECTED_CLASS,(function(t){return!a.hasFilter(t.x)}))):(t.classed(n.constants.SELECTED_CLASS,!1),t.classed(n.constants.DESELECTED_CLASS,!1));else if(a.brushIsEmpty(e))t.classed(n.constants.DESELECTED_CLASS,!1);else{var r=e[0],i=e[1];t.classed(n.constants.DESELECTED_CLASS,(function(t){return t.x<r||t.x>=i}))}},a.centerBar=function(t){return arguments.length?(l=t,a):l},n.override(a,"onClick",(function(t){a._onClick(t.data)})),a.barPadding=function(t){return arguments.length?(a._rangeBandPadding(t),o=void 0,a):a._rangeBandPadding()},a._useOuterPadding=function(){return void 0===o},a.outerPadding=a._outerRangeBandPadding,a.gap=function(t){return arguments.length?(o=t,a):o},a.extendBrush=function(){var t=a.brush().extent();return!a.round()||l&&!u||(t[0]=t.map(a.round())[0],t[1]=t.map(a.round())[1],a.chartBodyG().select(".brush").call(a.brush().extent(t))),t},a.alwaysUseRounding=function(t){return arguments.length?(u=t,a):u},a.legendHighlight=function(t){a.isLegendableHidden(t)||a.g().selectAll("rect.bar").classed("highlight",s(t.color)).classed("fadeout",s(t.color,!0))},a.legendReset=function(){a.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)},n.override(a,"xAxisMax",(function(){var t=this._xAxisMax();"resolution"in a.xUnits()&&(t+=a.xUnits().resolution);return t})),a.anchor(e,r)},n.lineChart=function(e,r){var i,a,o=n.stackMixin(n.coordinateGridMixin({})),l=!1,u=5,c=null,s=1e-6,f=1e-6,d="linear",g=.7,h=!0;function p(t,e){return o.getColor.call(t,t.values,e)}function x(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}function y(){return c||u}function m(t,e){o.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(n.pluck("data",o.title(e.name))))}function v(e,n,r){return function(){var i=t.select(this),a=i.attr("stroke")===e&&i.attr("stroke-dasharray")===(n instanceof Array?n.join(","):null)||i.attr("fill")===e;return r?!a:a}}return o.transitionDuration(500),o._rangeBandPadding(1),o.plotData=function(){var e=o.chartBodyG(),r=e.selectAll("g.stack-list");r.empty()&&(r=e.append("g").attr("class","stack-list"));var c=r.selectAll("g.stack").data(o.data()),h=c.enter().append("g").attr("class",(function(t,e){return"stack _"+e}));!function(e,r){var l=t.svg.line().x((function(t){return o.x()(t.x)})).y((function(t){return o.y()(t.y+t.y0)})).interpolate(d).tension(g);i&&l.defined(i);var u=e.append("path").attr("class","line").attr("stroke",p);a&&u.attr("stroke-dasharray",a);n.transition(r.select("path.line"),o.transitionDuration()).attr("stroke",p).attr("d",(function(t){return x(l(t.values))}))}(h,c),function(e,r){if(l){var a=t.svg.area().x((function(t){return o.x()(t.x)})).y((function(t){return o.y()(t.y+t.y0)})).y0((function(t){return o.y()(t.y0)})).interpolate(d).tension(g);i&&a.defined(i),e.append("path").attr("class","area").attr("fill",p).attr("d",(function(t){return x(a(t.values))})),n.transition(r.select("path.area"),o.transitionDuration()).attr("fill",p).attr("d",(function(t){return x(a(t.values))}))}}(h,c),function(e,r){if(!o.brushOn()&&o.xyTipsOn()){var a=e.select("g.dc-tooltip-list");a.empty()&&(a=e.append("g").attr("class","dc-tooltip-list")),r.each((function(e,r){var l=e.values;i&&(l=l.filter(i));var c=a.select("g.dc-tooltip._"+r);c.empty()&&(c=a.append("g").attr("class","dc-tooltip _"+r)),function(t){(t.select("path.yRef").empty()?t.append("path").attr("class","yRef"):t.select("path.yRef")).style("display","none").attr("stroke-dasharray","5,5"),(t.select("path.xRef").empty()?t.append("path").attr("class","xRef"):t.select("path.xRef")).style("display","none").attr("stroke-dasharray","5,5")}(c);var d=c.selectAll("circle.dot").data(l,n.pluck("x"));d.enter().append("circle").attr("class","dot").attr("r",y()).style("fill-opacity",s).style("stroke-opacity",f).on("mousemove",(function(){var e=t.select(this);!function(t){t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",u)}(e),function(t,e){var n=t.attr("cx"),r=t.attr("cy"),i="M"+(o._yAxisX()-o.margins().left)+" "+r+"L"+n+" "+r,a="M"+n+" "+o.yAxisHeight()+"L"+n+" "+r;e.select("path.yRef").style("display","").attr("d",i),e.select("path.xRef").style("display","").attr("d",a)}(e,c)})).on("mouseout",(function(){!function(t){t.style("fill-opacity",s).style("stroke-opacity",f).attr("r",y())}(t.select(this)),function(t){t.select("path.yRef").style("display","none"),t.select("path.xRef").style("display","none")}(c)})),d.attr("cx",(function(t){return n.utils.safeNumber(o.x()(t.x))})).attr("cy",(function(t){return n.utils.safeNumber(o.y()(t.y+t.y0))})).attr("fill",o.getColor).call(m,e),d.exit().remove()}))}}(e,c)},o.interpolate=function(t){return arguments.length?(d=t,o):d},o.tension=function(t){return arguments.length?(g=t,o):g},o.defined=function(t){return arguments.length?(i=t,o):i},o.dashStyle=function(t){return arguments.length?(a=t,o):a},o.renderArea=function(t){return arguments.length?(l=t,o):l},o.xyTipsOn=function(t){return arguments.length?(h=t,o):h},o.dotRadius=function(t){return arguments.length?(u=t,o):u},o.renderDataPoints=function(t){return arguments.length?(t?(s=t.fillOpacity||.8,f=t.strokeOpacity||.8,c=t.radius||2):(s=1e-6,f=1e-6,c=null),o):{fillOpacity:s,strokeOpacity:f,radius:c}},o.legendHighlight=function(t){o.isLegendableHidden(t)||o.g().selectAll("path.line, path.area").classed("highlight",v(t.color,t.dashstyle)).classed("fadeout",v(t.color,t.dashstyle,!0))},o.legendReset=function(){o.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)},n.override(o,"legendables",(function(){var t=o._legendables();return a?t.map((function(t){return t.dashstyle=a,t})):t})),o.anchor(e,r)},n.dataCount=function(e,r){var i=t.format(",d"),a=n.baseMixin({}),o={some:"",all:""};return a.html=function(t){return arguments.length?(t.all&&(o.all=t.all),t.some&&(o.some=t.some),a):o},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a._doRender=function(){var t=a.dimension().size(),e=a.group().value(),n=i(t),r=i(e);return t===e&&""!==o.all?a.root().html(o.all.replace("%total-count",n).replace("%filter-count",r)):""!==o.some?a.root().html(o.some.replace("%total-count",n).replace("%filter-count",r)):(a.selectAll(".total-count").text(n),a.selectAll(".filter-count").text(r)),a},a._doRedraw=function(){return a._doRender()},a.anchor(e,r)},n.dataTable=function(e,r){var i=n.baseMixin({}),a=25,o=[],l=function(t){return t},u=t.ascending,c=!0;return i._doRender=function(){return i.selectAll("tbody").remove(),function(t){var e=t.order().selectAll("tr.dc-table-row").data((function(t){return t.values})),n=e.enter().append("tr").attr("class","dc-table-row");o.forEach((function(t,e){n.append("td").attr("class","dc-table-column _"+e).html((function(e){return i._doColumnValueFormat(t,e)}))})),e.exit().remove()}(function(){var e=!0;if(o.forEach((function(t){e&="function"==typeof t})),!e){i.selectAll("th").remove(),i.root().selectAll("th").data(o).enter().append("th").attr("class","dc-table-head").html((function(t){return i._doColumnHeaderFormat(t)}))}var n=i.root().selectAll("tbody").data(function(){var e;e=u===t.ascending?i.dimension().bottom(a):i.dimension().top(a);return t.nest().key(i.group()).sortKeys(u).entries(e.sort((function(t,e){return u(l(t),l(e))})))}(),(function(t){return i.keyAccessor()(t)})),r=n.enter().append("tbody");!0===c&&r.append("tr").attr("class","dc-table-group").append("td").attr("class","dc-table-label").attr("colspan",o.length).html((function(t){return i.keyAccessor()(t)}));return n.exit().remove(),r}()),i},i._doColumnValueFormat=function(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)},i._doColumnHeaderFormat=function(t){return"function"==typeof t?i._doColumnHeaderFnToString(t):"string"==typeof t?i._doColumnHeaderCapitalize(t):String(t.label)},i._doColumnHeaderCapitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},i._doColumnHeaderFnToString=function(t){var e=String(t),n=e.indexOf("return ");if(n>=0){var r=e.lastIndexOf(";");if(r>=0)(e=e.substring(n+7,r)).indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}return e},i._doRedraw=function(){return i._doRender()},i.size=function(t){return arguments.length?(a=t,i):a},i.columns=function(t){return arguments.length?(o=t,i):o},i.sortBy=function(t){return arguments.length?(l=t,i):l},i.order=function(t){return arguments.length?(u=t,i):u},i.showGroups=function(t){return arguments.length?(c=t,i):c},i.anchor(e,r)},n.dataGrid=function(e,r){var i,a=n.baseMixin({}),o=999,l=function(t){return"you need to provide an html() handling param:  "+JSON.stringify(t)},u=function(t){return t},c=t.ascending,s=0,f=function(t){return"<div class='dc-grid-group'><h1 class='dc-grid-label'>"+a.keyAccessor()(t)+"</h1></div>"};return a._doRender=function(){return a.selectAll("div.dc-grid-top").remove(),function(t){var e=t.order().selectAll("div.dc-grid-item").data((function(t){return t.values}));e.enter().append("div").attr("class","dc-grid-item").html((function(t){return l(t)})),e.exit().remove()}(function(){var e=a.root().selectAll("div.dc-grid-top").data((r=a.dimension().top(o),t.nest().key(a.group()).sortKeys(c).entries(r.sort((function(t,e){return c(u(t),u(e))})).slice(s,i))),(function(t){return a.keyAccessor()(t)})),n=e.enter().append("div").attr("class","dc-grid-top");var r;f&&n.html((function(t){return f(t)}));return e.exit().remove(),n}()),a},a._doRedraw=function(){return a._doRender()},a.beginSlice=function(t){return arguments.length?(s=t,a):s},a.endSlice=function(t){return arguments.length?(i=t,a):i},a.size=function(t){return arguments.length?(o=t,a):o},a.html=function(t){return arguments.length?(l=t,a):l},a.htmlGroup=function(t){return arguments.length?(f=t,a):f},a.sortBy=function(t){return arguments.length?(u=t,a):u},a.order=function(t){return arguments.length?(c=t,a):c},a.anchor(e,r)},n.bubbleChart=function(t,e){var r=n.bubbleMixin(n.coordinateGridMixin({})),i=!1;r.transitionDuration(750);var a=function(t){return"translate("+function(t){var e=r.x()(r.keyAccessor()(t));isNaN(e)&&(e=0);return e}(t)+","+function(t){var e=r.y()(r.valueAccessor()(t));isNaN(e)&&(e=0);return e}(t)+")"};return r.elasticRadius=function(t){return arguments.length?(i=t,r):i},r.plotData=function(){i&&r.r().domain([r.rMin(),r.rMax()]),r.r().range([r.MIN_RADIUS,r.xAxisLength()*r.maxBubbleRelativeSize()]);var t=r.chartBodyG().selectAll("g."+r.BUBBLE_NODE_CLASS).data(r.data(),(function(t){return t.key}));!function(t){var e=t.enter().append("g");e.attr("class",r.BUBBLE_NODE_CLASS).attr("transform",a).append("circle").attr("class",(function(t,e){return r.BUBBLE_CLASS+" _"+e})).on("click",r.onClick).attr("fill",r.getColor).attr("r",0),n.transition(t,r.transitionDuration()).selectAll("circle."+r.BUBBLE_CLASS).attr("r",(function(t){return r.bubbleR(t)})).attr("opacity",(function(t){return r.bubbleR(t)>0?1:0})),r._doRenderLabel(e),r._doRenderTitles(e)}(t),function(t){n.transition(t,r.transitionDuration()).attr("transform",a).selectAll("circle."+r.BUBBLE_CLASS).attr("fill",r.getColor).attr("r",(function(t){return r.bubbleR(t)})).attr("opacity",(function(t){return r.bubbleR(t)>0?1:0})),r.doUpdateLabels(t),r.doUpdateTitles(t)}(t),function(t){t.exit().remove()}(t),r.fadeDeselectedArea()},r.renderBrush=function(){},r.redrawBrush=function(){r.fadeDeselectedArea()},r.anchor(t,e)},n.compositeChart=function(e,r){var i,a=n.coordinateGridMixin({}),o=[],l={},u=!1,c=!0,s=t.svg.axis(),f=0,d=12,g=!1;function h(t,e){t._generateG(a.g()),t.g().attr("class","sub _"+e)}function p(){return o.filter((function(t){return!t.useRightYAxis()}))}function x(){return o.filter((function(t){return t.useRightYAxis()}))}function y(t){return t.map((function(t){return t.yAxisMin()}))}function m(t){return t.map((function(t){return t.yAxisMax()}))}return a._mandatoryAttributes([]),a.transitionDuration(500),n.override(a,"_generateG",(function(){for(var t=this.__generateG(),e=0;e<o.length;++e){var n=o[e];h(n,e),n.dimension()||n.dimension(a.dimension()),n.group()||n.group(a.group()),n.chartGroup(a.chartGroup()),n.svg(a.svg()),n.xUnits(a.xUnits()),n.transitionDuration(a.transitionDuration()),n.brushOn(a.brushOn()),n.renderTitle(a.renderTitle()),n.elasticX(a.elasticX())}return t})),a._brushing=function(){for(var t=a.extendBrush(),e=a.brushIsEmpty(t),n=0;n<o.length;++n)o[n].filter(null),e||o[n].filter(t)},a._prepareYAxis=function(){0!==p().length&&function(){(void 0===a.y()||a.elasticY())&&(void 0===a.y()&&a.y(t.scale.linear()),a.y().domain([t.min(y(p())),n.utils.add(t.max(m(p())),a.yAxisPadding())]).rangeRound([a.yAxisHeight(),0]));a.y().range([a.yAxisHeight(),0]),a.yAxis(a.yAxis().scale(a.y())),a.yAxis().orient("left")}(),0!==x().length&&function(){(void 0===a.rightY()||a.elasticY())&&(void 0===a.rightY()&&a.rightY(t.scale.linear()),a.rightY().domain([t.min(y(x())),n.utils.add(t.max(m(x())),a.yAxisPadding())]).rangeRound([a.yAxisHeight(),0]));a.rightY().range([a.yAxisHeight(),0]),a.rightYAxis(a.rightYAxis().scale(a.rightY())),a.rightYAxis().orient("right")}(),p().length>0&&!g?a._renderHorizontalGridLinesForAxis(a.g(),a.y(),a.yAxis()):x().length>0&&a._renderHorizontalGridLinesForAxis(a.g(),i,s)},a.renderYAxis=function(){0!==p().length&&(a.renderYAxisAt("y",a.yAxis(),a.margins().left),a.renderYAxisLabel("y",a.yAxisLabel(),-90)),0!==x().length&&(a.renderYAxisAt("yr",a.rightYAxis(),a.width()-a.margins().right),a.renderYAxisLabel("yr",a.rightYAxisLabel(),90,a.width()-d))},a.plotData=function(){for(var t=0;t<o.length;++t){var e=o[t];e.g()||h(e,t),u&&e.colors(a.colors()),e.x(a.x()),e.xAxis(a.xAxis()),e.useRightYAxis()?(e.y(a.rightY()),e.yAxis(a.rightYAxis())):(e.y(a.y()),e.yAxis(a.yAxis())),e.plotData(),e._activateRenderlets()}},a.useRightAxisGridLines=function(t){return arguments?(g=t,a):g},a.childOptions=function(t){return arguments.length?(l=t,o.forEach((function(t){t.options(l)})),a):l},a.fadeDeselectedArea=function(){for(var t=0;t<o.length;++t){var e=o[t];e.brush(a.brush()),e.fadeDeselectedArea()}},a.rightYAxisLabel=function(t,e){return arguments.length?(f=t,a.margins().right-=d,d=void 0===e?12:e,a.margins().right+=d,a):f},a.compose=function(t){return(o=t).forEach((function(t){t.height(a.height()),t.width(a.width()),t.margins(a.margins()),c&&t.title(a.title()),t.options(l)})),a},a.children=function(){return o},a.shareColors=function(t){return arguments.length?(u=t,a):u},a.shareTitle=function(t){return arguments.length?(c=t,a):c},a.rightY=function(t){return arguments.length?(i=t,a.rescale(),a):i},delete a.yAxisMin,delete a.yAxisMax,n.override(a,"xAxisMin",(function(){return n.utils.subtract(t.min(o.map((function(t){return t.xAxisMin()}))),a.xAxisPadding())})),n.override(a,"xAxisMax",(function(){return n.utils.add(t.max(o.map((function(t){return t.xAxisMax()}))),a.xAxisPadding())})),a.legendables=function(){return o.reduce((function(t,e){return u&&e.colors(a.colors()),t.push.apply(t,e.legendables()),t}),[])},a.legendHighlight=function(t){for(var e=0;e<o.length;++e){o[e].legendHighlight(t)}},a.legendReset=function(t){for(var e=0;e<o.length;++e){o[e].legendReset(t)}},a.legendToggle=function(){console.log("composite should not be getting legendToggle itself")},a.rightYAxis=function(t){return arguments.length?(s=t,a):s},a.anchor(e,r)},n.seriesChart=function(e,r){var i=n.compositeChart(e,r);var a,o={},l=n.lineChart,u=t.ascending,c=function(e,n){return t.ascending(i.keyAccessor()(e),i.keyAccessor()(n))};function s(t){o[t].g()&&o[t].g().remove(),delete o[t]}function f(){Object.keys(o).map(s),o={}}return i._mandatoryAttributes().push("seriesAccessor","chart"),i.shareColors(!0),i._preprocessData=function(){var e,n=[],f=t.nest().key(a);u&&f.sortKeys(u),c&&f.sortValues(c);var d=f.entries(i.data()).map((function(a,u){var c=o[a.key]||l.call(i,i,r,a.key,u);return o[a.key]||(e=!0),o[a.key]=c,n.push(a.key),c.dimension(i.dimension()).group({all:t.functor(a.values)},a.key).keyAccessor(i.keyAccessor()).valueAccessor(i.valueAccessor()).brushOn(i.brushOn())}));Object.keys(o).filter((function(t){return-1===n.indexOf(t)})).forEach((function(t){s(t),e=!0})),i._compose(d),e&&i.legend()&&i.legend().render()},i.chart=function(t){return arguments.length?(l=t,f(),i):l},i.seriesAccessor=function(t){return arguments.length?(a=t,f(),i):a},i.seriesSort=function(t){return arguments.length?(u=t,f(),i):u},i.valueSort=function(t){return arguments.length?(c=t,f(),i):c},i._compose=i.compose,delete i.compose,i},n.geoChoroplethChart=function(e,r){var i=n.colorMixin(n.baseMixin({}));i.colorAccessor((function(t){return t||0}));var a,o=t.geo.path(),l=[];function u(e){var r=function(){for(var t={},e=i.data(),n=0;n<e.length;++n)t[i.keyAccessor()(e[n])]=i.valueAccessor()(e[n]);return t}();if(function(t){return d(t).keyAccessor}(e)){var a=function(t){return i.svg().selectAll(function(t){return"g.layer"+t+" g."+d(t).name}(t)).classed("selected",(function(e){return c(t,e)})).classed("deselected",(function(e){return s(t,e)})).attr("class",(function(e){var r=d(t).name+" "+n.utils.nameToId(d(t).keyAccessor(e));return c(t,e)&&(r+=" selected"),s(t,e)&&(r+=" deselected"),r}))}(e);!function(e,r,a){var o=e.select("path").attr("fill",(function(){var e=t.select(this).attr("fill");return e||"none"})).on("click",(function(t){return i.onClick(t,r)}));n.transition(o,i.transitionDuration()).attr("fill",(function(t,e){return i.getColor(a[d(r).keyAccessor(t)],e)}))}(a,e,r),function(t,e,n){i.renderTitle()&&t.selectAll("title").text((function(t){var r=f(e,t),a=n[r];return i.title()({key:r,value:a})}))}(a,e,r)}}function c(t,e){return i.hasFilter()&&i.hasFilter(f(t,e))}function s(t,e){return i.hasFilter()&&!i.hasFilter(f(t,e))}function f(t,e){return d(t).keyAccessor(e)}function d(t){return l[t]}return i._doRender=function(){i.resetSvg();for(var t=0;t<l.length;++t){var e=i.svg().append("g").attr("class","layer"+t).selectAll("g."+d(t).name).data(d(t).data).enter().append("g").attr("class",d(t).name);e.append("path").attr("fill","white").attr("d",o),e.append("title"),u(t)}a=!1},i.onClick=function(t,e){var r=d(e).keyAccessor(t);n.events.trigger((function(){i.filter(r),i.redrawGroup()}))},i._doRedraw=function(){for(var t=0;t<l.length;++t)u(t),a&&i.svg().selectAll("g."+d(t).name+" path").attr("d",o);a=!1},i.overlayGeoJson=function(t,e,n){for(var r=0;r<l.length;++r)if(l[r].name===e)return l[r].data=t,l[r].keyAccessor=n,i;return l.push({name:e,data:t,keyAccessor:n}),i},i.projection=function(t){return o.projection(t),a=!0,i},i.geoJsons=function(){return l},i.geoPath=function(){return o},i.removeGeoJson=function(t){for(var e=[],n=0;n<l.length;++n){var r=l[n];r.name!==t&&e.push(r)}return l=e,i},i.anchor(e,r)},n.bubbleOverlay=function(e,r){var i,a=n.bubbleMixin(n.baseMixin({})),o=[];function l(){var t={};return a.data().forEach((function(e){t[a.keyAccessor()(e)]=e})),t}function u(t,e){var r="node "+n.utils.nameToId(t.name),a=i.select("g."+n.utils.nameToId(t.name));return a.empty()&&(a=i.append("g").attr("class",r).attr("transform","translate("+t.x+","+t.y+")")),a.datum(e[t.name]),a}return a.transitionDuration(750),a.radiusValueAccessor((function(t){return t.value})),a.point=function(t,e,n){return o.push({name:t,x:e,y:n}),a},a._doRender=function(){var t;return i=function(){(i=a.select("g.bubble-overlay")).empty()&&(i=a.svg().append("g").attr("class","bubble-overlay"));return i}(),a.r().range([a.MIN_RADIUS,a.width()*a.maxBubbleRelativeSize()]),t=l(),o.forEach((function(e){var r=u(e,t),i=r.select("circle.bubble");i.empty()&&(i=r.append("circle").attr("class","bubble").attr("r",0).attr("fill",a.getColor).on("click",a.onClick)),n.transition(i,a.transitionDuration()).attr("r",(function(t){return a.bubbleR(t)})),a._doRenderLabel(r),a._doRenderTitles(r)})),a.fadeDeselectedArea(),a},a._doRedraw=function(){var t;return t=l(),o.forEach((function(e){var r=u(e,t),i=r.select("circle.bubble");n.transition(i,a.transitionDuration()).attr("r",(function(t){return a.bubbleR(t)})).attr("fill",a.getColor),a.doUpdateLabels(r),a.doUpdateTitles(r)})),a.fadeDeselectedArea(),a},a.debug=function(e){if(e){var r=a.select("g."+n.constants.DEBUG_GROUP_CLASS);r.empty()&&(r=a.svg().append("g").attr("class",n.constants.DEBUG_GROUP_CLASS));var i=r.append("text").attr("x",10).attr("y",20);r.append("rect").attr("width",a.width()).attr("height",a.height()).on("mousemove",(function(){var e=t.mouse(r.node()),n=e[0]+", "+e[1];i.text(n)}))}else a.selectAll(".debug").remove();return a},a.anchor(e,r),a},n.rowChart=function(e,r){var i,a,o,l,u=10,c=15,s=!1,f=2,d=5,g=!1,h=!1,p=n.capMixin(n.marginMixin(n.colorMixin(n.baseMixin({})))),x=t.svg.axis().orient("bottom");function y(){var e=i.select("g.axis");!function(){if(!a||o){var e=t.extent(l,p.cappedValueAccessor);e[0]>0&&(e[0]=0),a=t.scale.linear().domain(e).range([0,p.effectiveWidth()])}x.scale(a)}(),e.empty()&&(e=i.append("g").attr("class","axis")),e.attr("transform","translate(0, "+p.effectiveHeight()+")"),n.transition(e,p.transitionDuration()).call(x)}function m(){l=p.data(),y(),i.selectAll("g.tick").select("line.grid-line").remove(),i.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",(function(){return-p.effectiveHeight()}));var t=i.selectAll("g.row").data(l);!function(t){var e=t.enter().append("g").attr("class",(function(t,e){return"row _"+e}));e.append("rect").attr("width",0),function(t){p.renderLabel()&&t.append("text").on("click",b);p.renderTitleLabel()&&t.append("text").attr("class","titlerow").on("click",b)}(e),A(t)}(t),function(t){t.exit().remove()}(t),function(t){var e,r=l.length;e=g||(p.effectiveHeight()-(r+1)*d)/r;s||(c=e/2);var i=t.attr("transform",(function(t,n){return"translate(0,"+((n+1)*d+n*e)+")"})).select("rect").attr("height",e).attr("fill",p.getColor).on("click",b).classed("deselected",(function(t){return!!p.hasFilter()&&!k(t)})).classed("selected",(function(t){return!!p.hasFilter()&&k(t)}));n.transition(i,p.transitionDuration()).attr("width",(function(t){return Math.abs(v()-a(p.valueAccessor()(t)))})).attr("transform",_),function(t){p.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(p.title()))}(t),A(t)}(t)}function v(){var t=a(0);return t===-1/0||t!=t?a(1):t}function A(t){if(p.renderLabel()){var e=t.select("text").attr("x",u).attr("y",c).attr("dy","0.35em").on("click",b).attr("class",(function(t,e){return"row _"+e})).text((function(t){return p.label()(t)}));n.transition(e,p.transitionDuration()).attr("transform",_)}if(p.renderTitleLabel()){var r=t.select(".titlerow").attr("x",p.effectiveWidth()-f).attr("y",c).attr("text-anchor","end").on("click",b).attr("class",(function(t,e){return"titlerow _"+e})).text((function(t){return p.title()(t)}));n.transition(r,p.transitionDuration()).attr("transform",_)}}function b(t){p.onClick(t)}function _(t){var e=a(p.cappedValueAccessor(t)),n=v();return"translate("+(e>n?n:e)+",0)"}function k(t){return p.hasFilter(p.cappedKeyAccessor(t))}return p.rowsCap=p.cap,p._doRender=function(){return p.resetSvg(),i=p.svg().append("g").attr("transform","translate("+p.margins().left+","+p.margins().top+")"),m(),p},p.title((function(t){return p.cappedKeyAccessor(t)+": "+p.cappedValueAccessor(t)})),p.label(p.cappedKeyAccessor),p.x=function(t){return arguments.length?(a=t,p):a},p.renderTitleLabel=function(t){return arguments.length?(h=t,p):h},p._doRedraw=function(){return m(),p},p.xAxis=function(){return x},p.fixedBarHeight=function(t){return arguments.length?(g=t,p):g},p.gap=function(t){return arguments.length?(d=t,p):d},p.elasticX=function(t){return arguments.length?(o=t,p):o},p.labelOffsetX=function(t){return arguments.length?(u=t,p):u},p.labelOffsetY=function(t){return arguments.length?(c=t,s=!0,p):c},p.titleLabelOffsetX=function(t){return arguments.length?(f=t,p):f},p.anchor(e,r)},n.legend=function(){var t,e,r={},i=0,a=0,o=12,l=5,u=!1,c=560,s=70,f=!1;function d(){return l+o}return r.parent=function(e){return arguments.length?(t=e,r):t},r.render=function(){t.svg().select("g.dc-legend").remove(),e=t.svg().append("g").attr("class","dc-legend").attr("transform","translate("+i+","+a+")");var r=t.legendables(),g=e.selectAll("g.dc-legend-item").data(r).enter().append("g").attr("class","dc-legend-item").on("mouseover",(function(e){t.legendHighlight(e)})).on("mouseout",(function(e){t.legendReset(e)})).on("click",(function(t){t.chart.legendToggle(t)}));e.selectAll("g.dc-legend-item").classed("fadeout",(function(t){return t.chart.isLegendableHidden(t)})),r.some(n.pluck("dashstyle"))?g.append("line").attr("x1",0).attr("y1",o/2).attr("x2",o).attr("y2",o/2).attr("stroke-width",2).attr("stroke-dasharray",n.pluck("dashstyle")).attr("stroke",n.pluck("color")):g.append("rect").attr("width",o).attr("height",o).attr("fill",(function(t){return t?t.color:"blue"})),g.append("text").text(n.pluck("name")).attr("x",o+2).attr("y",(function(){return o/2+(this.clientHeight?this.clientHeight:13)/2-2}));var h=0,p=0;g.attr("transform",(function(t,e){if(u){var n="translate("+h+","+p*d()+")",r=!0===f?this.getBBox().width+l:s;return h+r>=c?(++p,h=0):h+=r,n}return"translate(0,"+e*d()+")"}))},r.x=function(t){return arguments.length?(i=t,r):i},r.y=function(t){return arguments.length?(a=t,r):a},r.gap=function(t){return arguments.length?(l=t,r):l},r.itemHeight=function(t){return arguments.length?(o=t,r):o},r.horizontal=function(t){return arguments.length?(u=t,r):u},r.legendWidth=function(t){return arguments.length?(c=t,r):c},r.itemWidth=function(t){return arguments.length?(s=t,r):s},r.autoItemWidth=function(t){return arguments.length?(f=t,r):f},r},n.scatterPlot=function(e,r){var i=n.coordinateGridMixin({}),a=t.svg.symbol(),o=function(t){return t.value},l=i.keyAccessor();i.keyAccessor((function(t){return l(t)[0]})),i.valueAccessor((function(t){return l(t)[1]})),i.colorAccessor((function(){return i._groupName}));var u=function(t){return"translate("+i.x()(i.keyAccessor()(t))+","+i.y()(i.valueAccessor()(t))+")"},c=3,s=5,f=0;function d(e,r){var o=i.selectAll(".chart-body path.symbol").filter((function(){return e(t.select(this))})),l=a.size();a.size(Math.pow(r,2)),n.transition(o,i.transitionDuration()).attr("d",a),a.size(l)}function g(t){var e=i.selectAll(".chart-body path.symbol").each((function(e){this.filtered=t&&t.isFiltered(e.key)}));n.transition(e,i.transitionDuration()).attr("d",a)}return a.size((function(t){return o(t)?this.filtered?Math.pow(s,2):Math.pow(c,2):f})),n.override(i,"_filter",(function(t){return arguments.length?i.__filter(n.filters.RangedTwoDimensionalFilter(t)):i.__filter()})),i.plotData=function(){var t=i.chartBodyG().selectAll("path.symbol").data(i.data());t.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",i.getColor).attr("transform",u),n.transition(t,i.transitionDuration()).attr("opacity",(function(t){return o(t)?1:0})).attr("fill",i.getColor).attr("transform",u).attr("d",a),n.transition(t.exit(),i.transitionDuration()).attr("opacity",0).remove()},i.existenceAccessor=function(t){return arguments.length?(o=t,this):o},i.symbol=function(t){return arguments.length?(a.type(t),i):a.type()},i.symbolSize=function(t){return arguments.length?(c=t,i):c},i.highlightedSize=function(t){return arguments.length?(s=t,i):s},i.hiddenSize=function(t){return arguments.length?(f=t,i):f},i.legendables=function(){return[{chart:i,name:i._groupName,color:i.getColor()}]},i.legendHighlight=function(e){d((function(t){return t.attr("fill")===e.color}),s),i.selectAll(".chart-body path.symbol").filter((function(){return t.select(this).attr("fill")!==e.color})).classed("fadeout",!0)},i.legendReset=function(e){d((function(t){return t.attr("fill")===e.color}),c),i.selectAll(".chart-body path.symbol").filter((function(){return t.select(this).attr("fill")!==e.color})).classed("fadeout",!1)},i.setHandlePaths=function(){},i.extendBrush=function(){var t=i.brush().extent();return i.round()&&(t[0]=t[0].map(i.round()),t[1]=t[1].map(i.round()),i.g().select(".brush").call(i.brush().extent(t))),t},i.brushIsEmpty=function(t){return i.brush().empty()||!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]},i._brushing=function(){var t=i.extendBrush();if(i.redrawBrush(i.g()),i.brushIsEmpty(t))n.events.trigger((function(){i.filter(null),i.redrawGroup()})),g(!1);else{var e=n.filters.RangedTwoDimensionalFilter(t);n.events.trigger((function(){i.filter(null),i.filter(e),i.redrawGroup()}),n.constants.EVENT_DELAY),g(e)}},i.setBrushY=function(t){t.call(i.brush().y(i.y()))},i.anchor(e,r)},n.numberDisplay=function(e,r){var i=t.format(".2s"),a=n.baseMixin({}),o={one:"",some:"",none:""};return a._mandatoryAttributes(["group"]),a.html=function(t){return arguments.length?(t.none?o.none=t.none:t.one?o.none=t.one:t.some&&(o.none=t.some),t.one?o.one=t.one:t.some&&(o.one=t.some),t.some?o.some=t.some:t.one&&(o.some=t.one),a):o},a.value=function(){return a.data()},a.data((function(t){var e=t.value?t.value():t.top(1)[0];return a.valueAccessor()(e)})),a.transitionDuration(250),a._doRender=function(){var e=a.value(),n=a.selectAll(".number-display");n.empty()&&(n=n.data([0]).enter().append("span").attr("class","number-display")),n.transition().duration(a.transitionDuration()).ease("quad-out-in").tween("text",(function(){var n=t.interpolateNumber(this.lastValue||0,e);return this.lastValue=e,function(t){var r=null,i=a.formatNumber()(n(t));0===e&&""!==o.none?r=o.none:1===e&&""!==o.one?r=o.one:""!==o.some&&(r=o.some),this.innerHTML=r?r.replace("%number",i):i}}))},a._doRedraw=function(){return a._doRender()},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a.anchor(e,r)},n.heatMap=function(e,r){var i,a,o,l=t.ascending,u=t.ascending,c=t.scale.ordinal(),s=t.scale.ordinal(),f=6.75,d=6.75,g=n.colorMixin(n.marginMixin(n.baseMixin({})));g._mandatoryAttributes(["group"]),g.title(g.colorAccessor());var h=function(t){return t},p=function(t){return t};g.colsLabel=function(t){return arguments.length?(h=t,g):h},g.rowsLabel=function(t){return arguments.length?(p=t,g):p};var x=function(t){v(0,t)},y=function(t){v(1,t)},m=function(t){var e=t.key;n.events.trigger((function(){g.filter(e),g.redrawGroup()}))};function v(t,e){var r=g.selectAll(".box-group").filter((function(n){return n.key[t]===e})),i=r.filter((function(t){return!g.hasFilter(t.key)}));n.events.trigger((function(){i.empty()?r.each((function(t){g.filter(t.key)})):i.each((function(t){g.filter(t.key)})),g.redrawGroup()}))}return n.override(g,"filter",(function(t){return arguments.length?g._filter(n.filters.TwoDimensionalFilter(t)):g._filter()})),g.rows=function(t){return arguments.length?(o=t,g):o},g.rowOrdering=function(t){return arguments.length?(u=t,g):u},g.cols=function(t){return arguments.length?(a=t,g):a},g.colOrdering=function(t){return arguments.length?(l=t,g):l},g._doRender=function(){return g.resetSvg(),i=g.svg().append("g").attr("class","heatmap").attr("transform","translate("+g.margins().left+","+g.margins().top+")"),g._doRedraw()},g._doRedraw=function(){var t=g.data(),e=g.rows()||t.map(g.valueAccessor()),r=g.cols()||t.map(g.keyAccessor());u&&(e=e.sort(u)),l&&(r=r.sort(l)),e=s.domain(e),r=c.domain(r);var a=e.domain().length,o=r.domain().length,h=Math.floor(g.effectiveWidth()/o),p=Math.floor(g.effectiveHeight()/a);r.rangeRoundBands([0,g.effectiveWidth()]),e.rangeRoundBands([g.effectiveHeight(),0]);var x=i.selectAll("g.box-group").data(g.data(),(function(t,e){return g.keyAccessor()(t,e)+"\0"+g.valueAccessor()(t,e)})),y=x.enter().append("g").attr("class","box-group");y.append("rect").attr("class","heat-box").attr("fill","white").on("click",g.boxOnClick()),g.renderTitle()&&(y.append("title"),x.selectAll("title").text(g.title())),n.transition(x.selectAll("rect"),g.transitionDuration()).attr("x",(function(t,e){return r(g.keyAccessor()(t,e))})).attr("y",(function(t,n){return e(g.valueAccessor()(t,n))})).attr("rx",f).attr("ry",d).attr("fill",g.getColor).attr("width",h).attr("height",p),x.exit().remove();var m=i.selectAll("g.cols");m.empty()&&(m=i.append("g").attr("class","cols axis"));var v=m.selectAll("text").data(r.domain());v.enter().append("text").attr("x",(function(t){return r(t)+h/2})).style("text-anchor","middle").attr("y",g.effectiveHeight()).attr("dy",12).on("click",g.xAxisOnClick()).text(g.colsLabel()),n.transition(v,g.transitionDuration()).text(g.colsLabel()).attr("x",(function(t){return r(t)+h/2})).attr("y",g.effectiveHeight()),v.exit().remove();var A=i.selectAll("g.rows");A.empty()&&(A=i.append("g").attr("class","rows axis"));var b=A.selectAll("text").data(e.domain());return b.enter().append("text").attr("dy",6).style("text-anchor","end").attr("x",0).attr("dx",-2).on("click",g.yAxisOnClick()).text(g.rowsLabel()),n.transition(b,g.transitionDuration()).text(g.rowsLabel()).attr("y",(function(t){return e(t)+p/2})),b.exit().remove(),g.hasFilter()?g.selectAll("g.box-group").each((function(t){g.isSelectedNode(t)?g.highlightSelected(this):g.fadeDeselected(this)})):g.selectAll("g.box-group").each((function(){g.resetHighlight(this)})),g},g.boxOnClick=function(t){return arguments.length?(m=t,g):m},g.xAxisOnClick=function(t){return arguments.length?(x=t,g):x},g.yAxisOnClick=function(t){return arguments.length?(y=t,g):y},g.xBorderRadius=function(t){return arguments.length?(f=t,g):f},g.yBorderRadius=function(t){return arguments.length?(d=t,g):d},g.isSelectedNode=function(t){return g.hasFilter(t.key)},g.anchor(e,r)},function(){function e(t){return[0,t.length-1]}function n(e){return[t.quantile(e,.25),t.quantile(e,.5),t.quantile(e,.75)]}t.box=function(){var r=1,i=1,a=0,o=null,l=Number,u=e,c=n,s=null;function f(e){e.each((function(e,n){e=e.map(l).sort(t.ascending);var f=t.select(this),d=e.length,g=e[0],h=e[d-1],p=e.quartiles=c(e),x=u&&u.call(this,e,n),y=x&&x.map((function(t){return e[t]})),m=x?t.range(0,x[0]).concat(t.range(x[1]+1,d)):t.range(d),v=t.scale.linear().domain(o&&o.call(this,e,n)||[g,h]).range([i,0]),A=this.__chart__||t.scale.linear().domain([0,1/0]).range(v.range());this.__chart__=v;var b=f.selectAll("line.center").data(y?[y]:[]);b.enter().insert("line","rect").attr("class","center").attr("x1",r/2).attr("y1",(function(t){return A(t[0])})).attr("x2",r/2).attr("y2",(function(t){return A(t[1])})).style("opacity",1e-6).transition().duration(a).style("opacity",1).attr("y1",(function(t){return v(t[0])})).attr("y2",(function(t){return v(t[1])})),b.transition().duration(a).style("opacity",1).attr("y1",(function(t){return v(t[0])})).attr("y2",(function(t){return v(t[1])})),b.exit().transition().duration(a).style("opacity",1e-6).attr("y1",(function(t){return v(t[0])})).attr("y2",(function(t){return v(t[1])})).remove();var _=f.selectAll("rect.box").data([p]);_.enter().append("rect").attr("class","box").attr("x",0).attr("y",(function(t){return A(t[2])})).attr("width",r).attr("height",(function(t){return A(t[0])-A(t[2])})).transition().duration(a).attr("y",(function(t){return v(t[2])})).attr("height",(function(t){return v(t[0])-v(t[2])})),_.transition().duration(a).attr("y",(function(t){return v(t[2])})).attr("height",(function(t){return v(t[0])-v(t[2])}));var k=f.selectAll("line.median").data([p[1]]);k.enter().append("line").attr("class","median").attr("x1",0).attr("y1",A).attr("x2",r).attr("y2",A).transition().duration(a).attr("y1",v).attr("y2",v),k.transition().duration(a).attr("y1",v).attr("y2",v);var C=f.selectAll("line.whisker").data(y||[]);C.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",A).attr("x2",r).attr("y2",A).style("opacity",1e-6).transition().duration(a).attr("y1",v).attr("y2",v).style("opacity",1),C.transition().duration(a).attr("y1",v).attr("y2",v).style("opacity",1),C.exit().transition().duration(a).attr("y1",v).attr("y2",v).style("opacity",1e-6).remove();var D=f.selectAll("circle.outlier").data(m,Number);D.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",r/2).attr("cy",(function(t){return A(e[t])})).style("opacity",1e-6).transition().duration(a).attr("cy",(function(t){return v(e[t])})).style("opacity",1),D.transition().duration(a).attr("cy",(function(t){return v(e[t])})).style("opacity",1),D.exit().transition().duration(a).attr("cy",(function(t){return v(e[t])})).style("opacity",1e-6).remove();var R=s||v.tickFormat(8),L=f.selectAll("text.box").data(p);L.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",(function(t,e){return 1&e?6:-6})).attr("x",(function(t,e){return 1&e?r:0})).attr("y",A).attr("text-anchor",(function(t,e){return 1&e?"start":"end"})).text(R).transition().duration(a).attr("y",v),L.transition().duration(a).text(R).attr("y",v);var S=f.selectAll("text.whisker").data(y||[]);S.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",r).attr("y",A).text(R).style("opacity",1e-6).transition().duration(a).attr("y",v).style("opacity",1),S.transition().duration(a).text(R).attr("y",v).style("opacity",1),S.exit().transition().duration(a).attr("y",v).style("opacity",1e-6).remove()})),t.timer.flush()}return f.width=function(t){return arguments.length?(r=t,f):r},f.height=function(t){return arguments.length?(i=t,f):i},f.tickFormat=function(t){return arguments.length?(s=t,f):s},f.duration=function(t){return arguments.length?(a=t,f):a},f.domain=function(e){return arguments.length?(o=null===e?e:t.functor(e),f):o},f.value=function(t){return arguments.length?(l=t,f):l},f.whiskers=function(t){return arguments.length?(u=t,f):u},f.quartiles=function(t){return arguments.length?(c=t,f):c},f}}(),n.boxPlot=function(e,r){var i=n.coordinateGridMixin({});var a=function(t){return function(e){var n=e.quartiles[0],r=e.quartiles[2],i=(r-n)*t,a=-1,o=e.length;do{++a}while(e[a]<n-i);do{--o}while(e[o]>r+i);return[a,o]}}(1.5),o=t.box(),l=null,u=function(t,e){return i.isOrdinal()?i.x().rangeBand():t/(1+i.boxPadding())/e};i.yAxisPadding(12),i.x(t.scale.ordinal()),i.xUnits(n.units.ordinal),i.data((function(t){return t.all().map((function(t){return t.map=function(e){return e.call(t,t)},t})).filter((function(t){return 0!==i.valueAccessor()(t).length}))})),i.boxPadding=i._rangeBandPadding,i.boxPadding(.8),i.outerPadding=i._outerRangeBandPadding,i.outerPadding(.5),i.boxWidth=function(e){return arguments.length?(u=t.functor(e),i):u};var c=function(t,e){return"translate("+i.x()(i.keyAccessor()(t,e))+", 0)"};return i._preprocessData=function(){i.elasticX()&&i.x().domain([])},i.plotData=function(){var e=u(i.effectiveWidth(),i.xUnitCount());o.whiskers(a).width(e).height(i.effectiveHeight()).value(i.valueAccessor()).domain(i.y().domain()).duration(i.transitionDuration()).tickFormat(l);var r=i.chartBodyG().selectAll("g.box").data(i.data(),(function(t){return t.key}));!function(t){t.enter().append("g").attr("class","box").attr("transform",c).call(o).on("click",(function(t){i.filter(t.key),i.redrawGroup()}))}(r),function(e){n.transition(e,i.transitionDuration()).attr("transform",c).call(o).each((function(){t.select(this).select("rect.box").attr("fill",i.getColor)}))}(r),function(t){t.exit().remove().call(o)}(r),i.fadeDeselectedArea()},i.fadeDeselectedArea=function(){i.hasFilter()?i.g().selectAll("g.box").each((function(t){i.isSelectedNode(t)?i.highlightSelected(this):i.fadeDeselected(this)})):i.g().selectAll("g.box").each((function(){i.resetHighlight(this)}))},i.isSelectedNode=function(t){return i.hasFilter(t.key)},i.yAxisMin=function(){var e=t.min(i.data(),(function(e){return t.min(i.valueAccessor()(e))}));return n.utils.subtract(e,i.yAxisPadding())},i.yAxisMax=function(){var e=t.max(i.data(),(function(e){return t.max(i.valueAccessor()(e))}));return n.utils.add(e,i.yAxisPadding())},i.tickFormat=function(t){return arguments.length?(l=t,i):l},i.anchor(e,r)},n.selectMenu=function(e,r){var i,a=n.baseMixin({}),o="Select all",l=!1,u=null,c=function(t,e){return a.keyAccessor()(t)>a.keyAccessor()(e)?1:a.keyAccessor()(e)>a.keyAccessor()(t)?-1:0},s=function(t){return a.valueAccessor()(t)>0};function f(){var t=i.selectAll("option.dc-select-option").data(a.data(),(function(t){return a.keyAccessor()(t)}));return t.enter().append("option").classed("dc-select-option",!0).attr("value",(function(t){return a.keyAccessor()(t)})),t.text(a.title()),t.exit().remove(),i.selectAll("option.dc-select-option").sort(c),i.on("change",d),t}function d(e,n){var r,i=t.event.target;i.selectedOptions?r=Array.prototype.slice.call(i.selectedOptions).map((function(t){return t.value})):r=[].slice.call(t.event.target.options).filter((function(t){return t.selected})).map((function(t){return t.value}));1===r.length&&""===r[0]?r=null:1===r.length&&(r=r[0]),a.onChange(r)}function g(){l?i.attr("multiple",!0):i.attr("multiple",null),null!==u?i.attr("size",u):i.attr("size",null)}return a.data((function(t){return t.all().filter(s)})),a._doRender=function(){return a.select("select").remove(),i=a.root().append("select").classed("dc-select-menu",!0),g(),i.append("option").text(o).attr("value",""),f(),a},a._doRedraw=function(){return g(),f(),a.hasFilter()&&l?i.selectAll("option").filter((function(t){return t&&a.filters().indexOf(String(a.keyAccessor()(t)))>=0})).property("selected",!0):a.hasFilter()?i.property("value",a.filter()):i.property("value",""),a},a.onChange=function(t){t&&l?a.replaceFilter([t]):t?a.replaceFilter(t):a.filterAll(),n.events.trigger((function(){a.redrawGroup()}))},a.order=function(t){return arguments.length?(c=t,a):c},a.promptText=function(t){return arguments.length?(o=t,a):o},a.filterDisplayed=function(t){return arguments.length?(s=t,a):s},a.multiple=function(t){return arguments.length?(l=t,a):l},a.size=function(t){return arguments.length?(u=t,a):u},a.anchor(e,r)},n.abstractBubbleChart=n.bubbleMixin,n.baseChart=n.baseMixin,n.capped=n.capMixin,n.colorChart=n.colorMixin,n.coordinateGridChart=n.coordinateGridMixin,n.marginable=n.marginMixin,n.stackableChart=n.stackMixin,n.d3=t,n.crossfilter=e,n}if("function"==typeof define&&define.amd)define(["d3","crossfilter"],t);else if("object"==typeof module&&module.exports){var e=require("d3"),n=require("crossfilter");"function"!=typeof n&&(n=n.crossfilter),module.exports=t(e,n)}else this.dc=t(d3,crossfilter)}();