define(["jquery",M.cfg.wwwroot+"/mod/page/lib/build/vue.min"],(function(e,t){t.component("ReadingTime",{props:[],data:function(){return{parantSelector:".longpage-container",language:"de",readingSpeedPerLanguage:{de:{cpm:250,variance:50}},slowSum:0,fastSum:0}},mounted:function(){this.calcH3(),this.calcH2()},methods:{calcH2:function(){let t=e("<span></span>").addClass("longpage-reading-time-estimation mx-0 my-1 p-0").text("Geschätzte Lesezeit "+this.fastSum+" - "+this.slowSum+" Minuten");e(this.parantSelector+" h2").after(t)},calcH3:function(){let t=e(this.parantSelector+" h3").length;e(this.parantSelector).append('<h3 style="display:inline;" class="dummy-heading-3">dummy</h3>');for(var a=0;a<t;a++){let t=0;var n=e("h3:nth("+a+")"),i=e("h3:nth("+(a+1)+")");e(n).nextUntil(i).addClass("tmp-marked-h3");var s="";e(".tmp-marked-h3").each((function(a){s+=e(this).text(),"IMG"===e(this).prop("tagName")&&t++,e(this).removeClass("tmp-marked-h3")}));let m=e("<div></div>").addClass("longpage-reading-time-estimation mx-0 my-3 p-0").text(this.estimateTime(s,t));n.after(m),e(".dummy-heading-3").remove()}},estimateTime:function(e,t){let a=e.match(/([\s]+)/g).length;t=0===parseInt(t,10)||"number"!=typeof t?1:t;let n=this.readingSpeedPerLanguage[this.language],i=Math.ceil(a/(n.cpm-n.variance)+.3*t),s=Math.ceil(a/(n.cpm+n.variance)+.3*t);return this.slowSum+=i,this.fastSum+=s,"Geschätzte Lesezeit "+s+"-"+i+" Minuten"}},template:"<div></div>"})}));