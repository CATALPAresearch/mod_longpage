define(["jquery"],(function(e){return require.config({enforceDefine:!1,paths:{Vue:[M.cfg.wwwroot+"/mod/page/lib/build/vue.min"],elasticlunr:[M.cfg.wwwroot+"/mod/page/lib/build/elasticlunr.min"],lunrde:[M.cfg.wwwroot+"/mod/page/lib/build/lunr.de.min"],stemmer:[M.cfg.wwwroot+"/mod/page/lib/build/lunr.stemmer.support.min"]}}),require(["Vue"],(function(t){t.component("Search",{props:["hideTabContent","log"],data:function(){return{index:{},search:"",searchResults:"",searchTerm:"",showSearchResults:!1}},mounted:function(){this.setupSearch()},methods:{setupSearch:function(){let t=this;require(["elasticlunr","lunrde","stemmer"],(function(n,i,s){n.addStopWords(["an","der","die","das"]),t.index=n(),t.index.addField("title"),t.index.addField("body"),t.index.setRef("id"),e(".longpage-container h2, .longpage-container h3, .longpage-container h4, .longpage-container div, .longpage-container p, .longpage-container ul, .longpage-container ol, .longpage-container pre").each((function(n,i){t.index.addDoc({id:n,title:e(i).text(),body:"",link:e(i).attr("id")})})),e(".longpage-container h2, .longpage-container h3, .longpage-container h4, .longpage-container div, .longpage-container p, .longpage-container ul, .longpage-container ol, .longpage-container pre").each((function(n,i){e(this).is("h2")||e(this).is("h3")||e(this).is("h4")?t.index.addDoc({id:n,title:e(i).text(),body:"",link:e(i).attr("id")}):(""!==e(i).attr("id")&&void 0!==e(i).attr("id")||e(i).attr("id",Math.ceil(1e3*Math.random())),t.index.addDoc({id:n,title:"",body:e(i).text(),link:e(i).attr("id")}))}))}))},doFulltextSearch:function(e){let t=this;this.showSearchResults=!0,""!==this.searchTerm&&(this.searchResults=this.index.search(String(this.searchTerm),{fields:{title:{boost:2},body:{boost:1}}}),this.searchResults=this.searchResults.map((function(e){let n=e.doc.body.indexOf(t.searchTerm);return e.doc.short=n>0?"... "+e.doc.body.substr(n-20>0?n-20:0,40):t.searchTerm,e})),log.add("searchterm",{searchterm:this.searchTerm,results:this.searchResults.length})),e.preventDefault()},searchResultClick:function(e){this.hideSearchResults(),log.add("searchresultselected",{searchterm:this.term,results:this.searchResults.length,selected:e.link,title:e.title})},hideSearchResults:function(){this.showSearchResults=!1}},template:'\n                    <div class="form-inline col-4 col-sm-4 col-xs-8 mb-1 px-0 mx-0">\n                        <input v-model="searchTerm" v-on:keyup.enter="doFulltextSearch" id="search-string" class="form-control form-control-sm mr-sm-2 d-inline w-50 d-flex ml-auto" type="search" placeholder="Suchen" aria-label="Search">\n                        <button @click="doFulltextSearch" id="search-full-text" class="btn btn-light btn-sm d-inline mr-0" type="button"><i class="fa fa-search"></i></button>\n                        <div v-if="showSearchResults" class="row w-100 px-0 mx-0" style="z-index:3000;">\n                            <div class="col-9 d-inline d-xs-none"></div>\n                            <div class="col-3 col-xs-12 p-3 bg-light" style="max-height:80vh; overflow:auto">\n                                <button type="button" class="close ml-auto align-self-center d-block" aria-label="Close" v-on:click="$emit(\'hideTabContent\')">\n                                    <span aria-hidden="true">&times;</span>\n                                </button>\n                                <br>\n                                <div class="mb-2">{{ searchResults.length }} Suchtreffer f√ºr \'{{ searchTerm }}\':</div>\n                                <ul id="search-results" class="list-unstyled">\n                                    <li class="mb-2" v-for="res in searchResults" v-if="res.doc.short.length > 0">\n                                        <a \n                                            class="underline"\n                                            style="word-wrap: break-word; color: #004C97 !important;"\n                                            :href="\'#\'+res.doc.link"\n                                            @click="searchResultClick(res.doc)"\n                                            >\n                                            {{ res.doc.short }}\n                                            </a>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n            '})}))}));